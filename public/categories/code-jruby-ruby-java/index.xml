<?xml version="1.0" encoding="utf-8" standalone="yes" ?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom">
  <channel>
    <title>Code Jruby Ruby Java on Sadique Ali</title>
    <link>http://sdqali.in/categories/code-jruby-ruby-java/</link>
    <description>Recent content in Code Jruby Ruby Java on Sadique Ali</description>
    <generator>Hugo -- gohugo.io</generator>
    <lastBuildDate>Tue, 16 Mar 2010 00:00:00 +0000</lastBuildDate>
    <atom:link href="http://sdqali.in/categories/code-jruby-ruby-java/index.xml" rel="self" type="application/rss+xml" />
    
    <item>
      <title>Java Arrays in JRuby</title>
      <link>http://sdqali.in/blog/2010/03/16/java-arrays-in-jruby/</link>
      <pubDate>Tue, 16 Mar 2010 00:00:00 +0000</pubDate>
      
      <guid>http://sdqali.in/blog/2010/03/16/java-arrays-in-jruby/</guid>
      <description>&lt;p&gt;Recently my team encountered a frustrating thing while working with a Java library in JRuby. It took us long to figure out what was going wrong. This is an attempt to write down what was happening.&lt;/p&gt;

&lt;p&gt;You are in Ruby world, a world of weak typing, no type casting and pure bliss in coding. You forget that some languages care about the type of elements in an Array. And you end up spending a lot of time figuring out why you are staring at a stupid looking exception.&lt;/p&gt;

&lt;p&gt;I will be using a dummy example for describing the problem.&lt;/p&gt;

&lt;p&gt;The following code snippet tries to compare two arrays in JRuby using Java Arrays&amp;rsquo; equals method. In JRuby world, one would expect this to work. Actually, one should not, but Ruby really gets into you.&lt;/p&gt;

&lt;pre&gt;&lt;code class=&#34;language-ruby&#34;&gt;require &#39;java&#39;
import &#39;java.util.Arrays&#39;

puts &amp;quot;Arrays equal&amp;quot; if Arrays.equals([1, 2, 3], [1, 2, 3])
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;Well, it does not. You get an error:&lt;/p&gt;

&lt;pre&gt;&lt;code class=&#34;language-bash&#34;&gt;no equals with arguments matching [class org.jruby.RubyArray, class org.jruby.RubyArray] on object Java::JavaUtil::Arrays (NameError)
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;This error message is informative. In our case, our unit tests threw an error that was very difficult to make any sense of. The reason why this fails is obvious.&lt;/p&gt;

&lt;p&gt;Java does care about the Type of things that form an Array. So you need to cast it to the correct type.&lt;/p&gt;

&lt;p&gt;Here is the code that actually works:&lt;/p&gt;

&lt;pre&gt;&lt;code class=&#34;language-ruby&#34;&gt;require &#39;java&#39;
import &#39;java.util.Arrays&#39;

puts &amp;quot;Arrays equal&amp;quot; if Arrays.equals([1,2,3].to_java(java.lang.Integer),
                                     [1,2,3].to_java(java.lang.Integer))
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;The &lt;code&gt;to_java&lt;/code&gt; method casts the elements of the Ruby array into Java array with elements of type specified.&lt;/p&gt;
</description>
    </item>
    
  </channel>
</rss>