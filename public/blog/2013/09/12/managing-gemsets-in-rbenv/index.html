<!DOCTYPE html5>
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en-us" prefix="og: http://ogp.me/ns#">
  <head>

    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="">
    <meta name="author" content="">

    <title>Managing Gemsets in Rbenv</title>

    
    <link href="/css/bootstrap.min.css" rel="stylesheet">

    
    <link href="/css/clean-blog.min.css" rel="stylesheet">

    
    <link href="http://maxcdn.bootstrapcdn.com/font-awesome/4.1.0/css/font-awesome.min.css" rel="stylesheet" type="text/css">
    <link href='http://fonts.googleapis.com/css?family=Lora:400,700,400italic,700italic' rel='stylesheet' type='text/css'>
    <link href='http://fonts.googleapis.com/css?family=Open+Sans:300italic,400italic,600italic,700italic,800italic,400,300,600,700,800' rel='stylesheet' type='text/css'>

    
    
    

</head>

  
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:site" content="@sdqali">
  <meta name="twitter:creator" content="@sdqali">
  <meta name="twitter:title" content="Managing Gemsets in Rbenv">
  <meta name="twitter:description" content="When I was setting up my new laptop today, I decided to use Rbenv [^1] to manage my Ruby versions. I have typically used RVM [^2] and had never used Rbenv. Rbenv is a Ruby version manager written by Sam Stephenson and deliberately tries to do less and do it well. Instead of overriding Bash commands like RVM does, Rbenv chooses to use wrappers or shims around Ruby binaries to choose the Ruby executable to run.

This works well, until you have to manage Gemsets [^3]. Often, one is working on two projects that use the same version of Ruby, but has entirely different chain of dependency on Gems. RVM&rsquo;s gemsets work really well for this use case. I was looking around to see how one would manage gemsets with Rbenv. There are three ways to do it.
">
  <meta name="twitter:image" content="http://sdqali.in/map[feature:/images/threaded-blue-on-black-cropped.jpg]">

  <meta property="og:title" content="Managing Gemsets in Rbenv" />
  <meta property="og:description" content="When I was setting up my new laptop today, I decided to use Rbenv [^1] to manage my Ruby versions. I have typically used RVM [^2] and had never used Rbenv. Rbenv is a Ruby version manager written by Sam Stephenson and deliberately tries to do less and do it well. Instead of overriding Bash commands like RVM does, Rbenv chooses to use wrappers or shims around Ruby binaries to choose the Ruby executable to run.

This works well, until you have to manage Gemsets [^3]. Often, one is working on two projects that use the same version of Ruby, but has entirely different chain of dependency on Gems. RVM&rsquo;s gemsets work really well for this use case. I was looking around to see how one would manage gemsets with Rbenv. There are three ways to do it.
" itemprop="description"/>
  <meta property="og:url" content="http://sdqali.in/blog/2013/09/12/managing-gemsets-in-rbenv/" />
  <meta property="og:image" content="http://sdqali.in/map[feature:/images/threaded-blue-on-black-cropped.jpg]" />
  <body>

    <nav class="navbar navbar-default navbar-custom navbar-fixed-top">
  <div class="container-fluid">
    
    <div class="navbar-header page-scroll">
      <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="/">Sadique Ali</a>
    </div>

    
    <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
      <ul class="nav navbar-nav navbar-right">
        <li><a href="/">Home</a> </li>
        <li><a href="/blog/">Blog</a> </li>
        <li><a href="/about">About</a> </li>
        <li><a href="https://github.com/sdqali">GitHub</a> </li>
        <li><a href="https://twitter.com/sdqali">Twitter</a> </li>
        <li><a href="https://www.linkedin.com/in/sdqali">LinkedIn</a> </li>
      </ul>
    </div>
    
  </div>
  
</nav>




    
    
    <header class="intro-header" style="background-image: url('/img/home-bg.jpg')">
      <div class="container">
        <div class="row">
          <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
            <div class="site-heading">
              <h1> Managing Gemsets in Rbenv</h1>
              <span class="meta">Thu, Sep 12, 2013</span>
            </div>
          </div>
        </div>
      </div>
    </header>


    
    <article>
      <div class="container">
        <div class="row">
          <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
            

<p>When I was setting up my new laptop today, I decided to use Rbenv <sup class="footnote-ref" id="fnref:85e1ecb3737055d5335b82c4e19bf867:1"><a rel="footnote" href="#fn:85e1ecb3737055d5335b82c4e19bf867:1">1</a></sup> to manage my Ruby versions. I have typically used RVM <sup class="footnote-ref" id="fnref:85e1ecb3737055d5335b82c4e19bf867:2"><a rel="footnote" href="#fn:85e1ecb3737055d5335b82c4e19bf867:2">2</a></sup> and had never used Rbenv. Rbenv is a Ruby version manager written by <a href="https://github.com/sstephenson/">Sam Stephenson</a> and deliberately tries to do less and do it well. Instead of overriding Bash commands like RVM does, Rbenv chooses to use wrappers or <strong>shims</strong> around Ruby binaries to choose the Ruby executable to run.</p>

<p>This works well, until you have to manage Gemsets <sup class="footnote-ref" id="fnref:85e1ecb3737055d5335b82c4e19bf867:3"><a rel="footnote" href="#fn:85e1ecb3737055d5335b82c4e19bf867:3">3</a></sup>. Often, one is working on two projects that use the same version of Ruby, but has entirely different chain of dependency on Gems. RVM&rsquo;s gemsets work really well for this use case. I was looking around to see how one would manage gemsets with Rbenv. There are three ways to do it.</p>

<h2 id="use-the-rbenv-gemset-plugin:85e1ecb3737055d5335b82c4e19bf867">Use the <code>rbenv-gemset</code> plugin</h2>

<p><a href="https://github.com/jf">Jeffrey Lim</a>&rsquo;s <code>rbenv-gemset</code><sup class="footnote-ref" id="fnref:85e1ecb3737055d5335b82c4e19bf867:4"><a rel="footnote" href="#fn:85e1ecb3737055d5335b82c4e19bf867:4">4</a></sup> plugin forces Rbenv to look in a specific path for gems. A typical workflow of using the plugin will be as follows.</p>

<ul>
<li>Specify the gemset by adding it&rsquo;s name to a <code>rbenv-gemsets</code> file in the root directory of the project.
<code>bash
cat rbenv-gemsets
$ .gems
</code></li>
<li>Install the gems, by using <code>gem install</code> or with bundler.</li>
<li>The gems will be installed in <code>.gems</code> directory under the project root.</li>
<li>Ruby will look for gems in the <code>.gems</code> directory.</li>
</ul>

<h2 id="use-bundler-to-manage-gemsets:85e1ecb3737055d5335b82c4e19bf867">Use bundler to manage gemsets</h2>

<p>In this approach, we will be using bundler&rsquo;s <code>--path</code> flag to install the gemset to a local directory and then wrap all calls with <code>bundle exec</code>. A typical workflow in this case will look like this.</p>

<ul>
<li>Install gems to a <code>.gems</code> directory using bundler
<code>bash
bundle install --path .gems
</code></li>
<li>Wrap calls with <code>bundle exec</code>
<code>bash
bundle exec rake --version
</code></li>
</ul>

<h2 id="use-a-devenv-file:85e1ecb3737055d5335b82c4e19bf867">Use a devenv file</h2>

<p>This is a hacky way doing things and it was the first that came to my mind when I was looking at this problem. This approach involves adding a project specific <code>devenv</code> file that is sourced when one starts to work on that project. This file will set the <code>GEM_HOME</code> and <code>GEM_PATH</code> environment variables to the directory where the gemset is supposed to live as well as prepend the <code>gems/bin</code> directory of the gemset to <code>PATH</code>. An example <code>devenv</code> file will be as follows</p>
<div class="highlight" style="background: #f0f3f3"><pre style="line-height: 125%"><span></span><span style="color: #336666">export</span> <span style="color: #003333">GEM_PATH</span><span style="color: #555555">=</span>./.gems
<span style="color: #336666">export</span> <span style="color: #003333">GEM_HOME</span><span style="color: #555555">=</span>./.gems
<span style="color: #336666">export</span> <span style="color: #003333">PATH</span><span style="color: #555555">=</span>./.gems/bin:<span style="color: #003333">$PATH</span>
</pre></div>

<p>In the end, I ended up choosing the <code>bundler</code> approach. I use bundler in most of my Ruby projects anyway. The downside to this is that every invocation will be spawning a <code>bundler</code> process, in addition to whatever we intend to do.</p>
<div class="footnotes">

<hr />

<ol>
<li id="fn:85e1ecb3737055d5335b82c4e19bf867:1">Rbenv is used to pick a Ruby version for an application and guarantee that the development environment matches production. <a href="https://github.com/sstephenson/rbenv">Rbenv - Groom your appâ€™s Ruby environment</a>.
 <a class="footnote-return" href="#fnref:85e1ecb3737055d5335b82c4e19bf867:1"><sup>[return]</sup></a></li>
<li id="fn:85e1ecb3737055d5335b82c4e19bf867:2">RVM is a command-line tool which allows you to easily install, manage, and work with multiple ruby environments from interpreters to sets of gems. <a href="https://rvm.io/">RVM - Cut Rubies with ease!</a>.
 <a class="footnote-return" href="#fnref:85e1ecb3737055d5335b82c4e19bf867:2"><sup>[return]</sup></a></li>
<li id="fn:85e1ecb3737055d5335b82c4e19bf867:3">Gemsets are collection of Ruby gems specific to a project. This <a href="http://stackoverflow.com/questions/11086661/why-should-i-use-application-specific-rvm-gemsets-in-addition-to-bundler">StackOverflow question</a> answers why one should use gemsets.
 <a class="footnote-return" href="#fnref:85e1ecb3737055d5335b82c4e19bf867:3"><sup>[return]</sup></a></li>
<li id="fn:85e1ecb3737055d5335b82c4e19bf867:4"><a href="https://github.com/jf/rbenv-gemset"><code>rbenv-gemsets</code> - Gem management for Rbenv</a>.
 <a class="footnote-return" href="#fnref:85e1ecb3737055d5335b82c4e19bf867:4"><sup>[return]</sup></a></li>
</ol>
</div>

          </div>
        </div>
      </div>
    </article>

    <hr>

    
<footer>
  <div class="container">
    <div class="row">
      <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
        <ul class="list-inline text-center">
          <li>
            <a href="https://twitter.com/sdqali">
              <span class="fa-stack fa-lg">
                <i class="fa fa-circle fa-stack-2x"></i>
                <i class="fa fa-twitter fa-stack-1x fa-inverse"></i>
              </span>
            </a>
          </li>
          <li>
            <a href="https://linkedin.com/in/sdqali">
              <span class="fa-stack fa-lg">
                <i class="fa fa-circle fa-stack-2x"></i>
                <i class="fa fa-linkedin fa-stack-1x fa-inverse"></i>
              </span>
            </a>
          </li>
          <li>
            <a href="https://github.com/sdqali">
              <span class="fa-stack fa-lg">
                <i class="fa fa-circle fa-stack-2x"></i>
                <i class="fa fa-github fa-stack-1x fa-inverse"></i>
              </span>
            </a>
          </li>
        </ul>
        <p class="copyright text-muted">&copy; All rights reserved.</p>
      </div>
    </div>
  </div>
</footer>


<script src="/js/jquery.js"></script>


<script src="/js/bootstrap.min.js"></script>


<script src="/js/clean-blog.min.js"></script>

  </body>
</html>
