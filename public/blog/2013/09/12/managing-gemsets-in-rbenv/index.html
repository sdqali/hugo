<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en-us" prefix="og: http://ogp.me/ns#">
  <head>
    <link href="http://gmpg.org/xfn/11" rel="profile">
    <meta http-equiv="content-type" content="text/html; charset=utf-8">

    
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1">

    <title> Managing Gemsets in Rbenv &middot; Sadique Ali </title>

    
    <link rel="stylesheet" href="http://sdqali.in/css/poole.css">
    <link rel="stylesheet" href="http://sdqali.in/css/syntax.css">
    <link rel="stylesheet" href="http://sdqali.in/css/hyde.css">
    <link rel="stylesheet" href="http://sdqali.in/css/default.min.css">
    <link rel="stylesheet" href="http://sdqali.in/css/custom.css">
    <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=PT+Sans:400,400italic,700|Abril+Fatface">

    
    <link rel="apple-touch-icon" sizes="57x57" href="/apple-touch-icon-57x57.png">
    <link rel="apple-touch-icon" sizes="60x60" href="/apple-touch-icon-60x60.png">
    <link rel="apple-touch-icon" sizes="72x72" href="/apple-touch-icon-72x72.png">
    <link rel="apple-touch-icon" sizes="76x76" href="/apple-touch-icon-76x76.png">
    <link rel="apple-touch-icon" sizes="114x114" href="/apple-touch-icon-114x114.png">
    <link rel="apple-touch-icon" sizes="120x120" href="/apple-touch-icon-120x120.png">
    <link rel="apple-touch-icon" sizes="144x144" href="/apple-touch-icon-144x144.png">
    <link rel="apple-touch-icon" sizes="152x152" href="/apple-touch-icon-152x152.png">
    <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon-180x180.png">
    <link rel="icon" type="image/png" href="/favicon-32x32.png" sizes="32x32">
    <link rel="icon" type="image/png" href="/android-chrome-192x192.png" sizes="192x192">
    <link rel="icon" type="image/png" href="/favicon-96x96.png" sizes="96x96">
    <link rel="icon" type="image/png" href="/favicon-16x16.png" sizes="16x16">
    <link rel="manifest" href="/manifest.json">
    <link rel="mask-icon" href="/safari-pinned-tab.svg" color="#5bbad5">
    <meta name="msapplication-TileColor" content="#da532c">
    <meta name="msapplication-TileImage" content="/mstile-144x144.png">
    <meta name="theme-color" content="#ffffff">

    <script src="https://d26b395fwzu5fz.cloudfront.net/3.3.0/keen.min.js" type="text/javascript"></script>
    <script src="http://sdqali.in/js/parseuri.js" type="text/javascript"></script>
    <script src="http://sdqali.in/js/ua-parser.min.js" type="text/javascript"></script>
    <script src="http://sdqali.in/js/Math.uuid.js" type="text/javascript"></script>

    
    <link href="" rel="alternate" type="application/rss+xml" title="Sadique Ali" />

    <script type="text/javascript" src="http://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.0.0/highlight.min.js"></script>
    <script type="text/javascript">
      hljs.initHighlightingOnLoad();
    </script>

    <script type="text/javascript">
  var client = new Keen({
    projectId: "566f9f7a96773d75e098bb34", 
    writeKey: "5d41bf4e9b86ee088f2ae748d782f6e40501d9f1807e04cd3c2bea52c276f14416f585877c39785704bdd5407aae393cc8ad601646d2112f8293a0269145baebec15f48e073186173b9e6c82cd3767456296c77a46d23b827c82492116d919e8401dfa84c56f13adac91963575522314",   
    readKey: "57d95890c1893e97bb47ff02d5082242490a5f0585777e5f157ff3c5f01aca1c1e5bdaab91d874668b7154981d14dd5d73e3a54ef3360e93f29ea1b50b36b339e0e0fe063347fa6ce9bf9f1536752fa81bf2e12079a21e2e57312a55260403f09915e11455cb98e69a2dc9094c14184a"      
  });

var uri = parseUri(window.location.href);
var referrer = parseUri(document.referrer);
var uaParser = new UAParser();
client.addEvent("pagehit", {
  "url" : {
    "source" : uri.source,
    "protocol" : uri.protocol,
    "domain" : uri.host,
    "port" : uri.port,
    "path" : uri.path,
    "anchor" : uri.anchor
  },
  "user_agent" : {
    "browser" : uaParser.getBrowser(),
    "engine" : uaParser.getEngine(),
    "os" : uaParser.getOS()
  },
  referrer: {
    "source" : referrer.source,
    "protocol" : referrer.protocol,
    "domain" : referrer.host,
    "port" : referrer.port,
    "path" : referrer.path,
    "anchor" : referrer.anchor
  },
  "session_id" : Math.uuid(),
  "permanent_tracker" : Math.uuid()
});
</script>

  </head>


<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:site" content="@sdqali">
<meta name="twitter:creator" content="@sdqali">
<meta name="twitter:title" content="Managing Gemsets in Rbenv">
<meta name="twitter:description" content="When I was setting up my new laptop today, I decided to use Rbenv [^1] to manage my Ruby versions. I have typically used RVM [^2] and had never used Rbenv. Rbenv is a Ruby version manager written by Sam Stephenson and deliberately tries to do less and do it well. Instead of overriding Bash commands like RVM does, Rbenv chooses to use wrappers or shims around Ruby binaries to choose the Ruby executable to run.

This works well, until you have to manage Gemsets [^3]. Often, one is working on two projects that use the same version of Ruby, but has entirely different chain of dependency on Gems. RVM&rsquo;s gemsets work really well for this use case. I was looking around to see how one would manage gemsets with Rbenv. There are three ways to do it.
">
<meta name="twitter:image" content="http://sdqali.in/map[feature:/images/threaded-blue-on-black-cropped.jpg]">

<meta property="og:title" content="Managing Gemsets in Rbenv" />
<meta property="og:description" content="When I was setting up my new laptop today, I decided to use Rbenv [^1] to manage my Ruby versions. I have typically used RVM [^2] and had never used Rbenv. Rbenv is a Ruby version manager written by Sam Stephenson and deliberately tries to do less and do it well. Instead of overriding Bash commands like RVM does, Rbenv chooses to use wrappers or shims around Ruby binaries to choose the Ruby executable to run.

This works well, until you have to manage Gemsets [^3]. Often, one is working on two projects that use the same version of Ruby, but has entirely different chain of dependency on Gems. RVM&rsquo;s gemsets work really well for this use case. I was looking around to see how one would manage gemsets with Rbenv. There are three ways to do it.
" itemprop="description"/>
<meta property="og:url" content="http://sdqali.in/blog/2013/09/12/managing-gemsets-in-rbenv/" />
<meta property="og:image" content="http://sdqali.in/map[feature:/images/threaded-blue-on-black-cropped.jpg]" />
<body class="theme-base-0b">

<div class="sidebar">
  <div class="container sidebar-sticky">
    <div class="sidebar-about">
      <h1>
	<a href="/">Sadique Ali</a>
      </h1>
      <p class="lead">
       A blog about the Code I write and the Technologies I use. And other things that interest me. 
      </p>
    </div>

    <ul class="sidebar-nav">
      <li><a href="/">Home</a> </li>
      <li><a href="/blog/">Blog</a> </li>
      <li><a href="/about">About</a> </li>
      <li><a href="https://github.com/sdqali">GitHub</a> </li>
      <li><a href="https://twitter.com/sdqali">Twitter</a> </li>
      <li><a href="https://www.linkedin.com/in/sdqali">LinkedIn</a> </li>
      
    </ul>

    <p>&copy; 2015. All rights reserved. </p>
  </div>
</div>


<div class="content container" itemscope itemtype="http://schema.org/BlogPosting">
<meta itemscope itemprop="mainEntityOfPage"  itemType="https://schema.org/WebPage" itemid="http://sdqali.in/blog/2013/09/12/managing-gemsets-in-rbenv/"/>
<meta itemprop="datePublished" content="2013-09-12 00:00:00 &#43;0000 UTC"/>
<meta itemprop="dateModified" content="2013-09-12 00:00:00 &#43;0000 UTC"/>

<div class="post">
  <h1 itemprop="headline">Managing Gemsets in Rbenv</h1>
  <div class="author" itemprop="author" itemscope itemtype="https://schema.org/Person">
    By <span itemprop="name">Sadique Ali</span>
  </div>
  <span class="post-date">Thu, Sep 12, 2013</span>
      

<p>When I was setting up my new laptop today, I decided to use Rbenv <sup class="footnote-ref" id="fnref:85e1ecb3737055d5335b82c4e19bf867:1"><a rel="footnote" href="#fn:85e1ecb3737055d5335b82c4e19bf867:1">1</a></sup> to manage my Ruby versions. I have typically used RVM <sup class="footnote-ref" id="fnref:85e1ecb3737055d5335b82c4e19bf867:2"><a rel="footnote" href="#fn:85e1ecb3737055d5335b82c4e19bf867:2">2</a></sup> and had never used Rbenv. Rbenv is a Ruby version manager written by <a href="https://github.com/sstephenson/">Sam Stephenson</a> and deliberately tries to do less and do it well. Instead of overriding Bash commands like RVM does, Rbenv chooses to use wrappers or <strong>shims</strong> around Ruby binaries to choose the Ruby executable to run.</p>

<p>This works well, until you have to manage Gemsets <sup class="footnote-ref" id="fnref:85e1ecb3737055d5335b82c4e19bf867:3"><a rel="footnote" href="#fn:85e1ecb3737055d5335b82c4e19bf867:3">3</a></sup>. Often, one is working on two projects that use the same version of Ruby, but has entirely different chain of dependency on Gems. RVM&rsquo;s gemsets work really well for this use case. I was looking around to see how one would manage gemsets with Rbenv. There are three ways to do it.</p>

<h2 id="use-the-rbenv-gemset-plugin:85e1ecb3737055d5335b82c4e19bf867">Use the <code>rbenv-gemset</code> plugin</h2>

<p><a href="https://github.com/jf">Jeffrey Lim</a>&rsquo;s <code>rbenv-gemset</code><sup class="footnote-ref" id="fnref:85e1ecb3737055d5335b82c4e19bf867:4"><a rel="footnote" href="#fn:85e1ecb3737055d5335b82c4e19bf867:4">4</a></sup> plugin forces Rbenv to look in a specific path for gems. A typical workflow of using the plugin will be as follows.</p>

<ul>
<li>Specify the gemset by adding it&rsquo;s name to a <code>rbenv-gemsets</code> file in the root directory of the project.</li>
</ul>

<pre><code class="language-bash">cat rbenv-gemsets
$ .gems
</code></pre>

<ul>
<li>Install the gems, by using <code>gem install</code> or with bundler.</li>
<li>The gems will be installed in <code>.gems</code> directory under the project root.</li>
<li>Ruby will look for gems in the <code>.gems</code> directory.</li>
</ul>

<h2 id="use-bundler-to-manage-gemsets:85e1ecb3737055d5335b82c4e19bf867">Use bundler to manage gemsets</h2>

<p>In this approach, we will be using bundler&rsquo;s <code>--path</code> flag to install the gemset to a local directory and then wrap all calls with <code>bundle exec</code>. A typical workflow in this case will look like this.</p>

<ul>
<li>Install gems to a <code>.gems</code> directory using bundler</li>
</ul>

<pre><code class="language-bash">bundle install --path .gems
</code></pre>

<ul>
<li>Wrap calls with <code>bundle exec</code></li>
</ul>

<pre><code class="language-bash">bundle exec rake --version
</code></pre>

<h2 id="use-a-devenv-file:85e1ecb3737055d5335b82c4e19bf867">Use a devenv file</h2>

<p>This is a hacky way doing things and it was the first that came to my mind when I was looking at this problem. This approach involves adding a project specific <code>devenv</code> file that is sourced when one starts to work on that project. This file will set the <code>GEM_HOME</code> and <code>GEM_PATH</code> environment variables to the directory where the gemset is supposed to live as well as prepend the <code>gems/bin</code> directory of the gemset to <code>PATH</code>. An example <code>devenv</code> file will be as follows</p>

<pre><code class="language-bash">export GEM_PATH=./.gems
export GEM_HOME=./.gems
export PATH=./.gems/bin:$PATH
</code></pre>

<p>In the end, I ended up choosing the <code>bundler</code> approach. I use bundler in most of my Ruby projects anyway. The downside to this is that every invocation will be spawning a <code>bundler</code> process, in addition to whatever we intend to do.</p>
<div class="footnotes">

<hr />

<ol>
<li id="fn:85e1ecb3737055d5335b82c4e19bf867:1">Rbenv is used to pick a Ruby version for an application and guarantee that the development environment matches production. <a href="https://github.com/sstephenson/rbenv">Rbenv - Groom your app’s Ruby environment</a>.
 <a class="footnote-return" href="#fnref:85e1ecb3737055d5335b82c4e19bf867:1"><sup>[return]</sup></a></li>
<li id="fn:85e1ecb3737055d5335b82c4e19bf867:2">RVM is a command-line tool which allows you to easily install, manage, and work with multiple ruby environments from interpreters to sets of gems. <a href="https://rvm.io/">RVM - Cut Rubies with ease!</a>.
 <a class="footnote-return" href="#fnref:85e1ecb3737055d5335b82c4e19bf867:2"><sup>[return]</sup></a></li>
<li id="fn:85e1ecb3737055d5335b82c4e19bf867:3">Gemsets are collection of Ruby gems specific to a project. This <a href="http://stackoverflow.com/questions/11086661/why-should-i-use-application-specific-rvm-gemsets-in-addition-to-bundler">StackOverflow question</a> answers why one should use gemsets.
 <a class="footnote-return" href="#fnref:85e1ecb3737055d5335b82c4e19bf867:3"><sup>[return]</sup></a></li>
<li id="fn:85e1ecb3737055d5335b82c4e19bf867:4"><a href="https://github.com/jf/rbenv-gemset"><code>rbenv-gemsets</code> - Gem management for Rbenv</a>.
 <a class="footnote-return" href="#fnref:85e1ecb3737055d5335b82c4e19bf867:4"><sup>[return]</sup></a></li>
</ol>
</div>

</div>
</div>

  </body>
</html>
