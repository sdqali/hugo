<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en-us" prefix="og: http://ogp.me/ns#">
  <head>
    <link href="http://gmpg.org/xfn/11" rel="profile">
    <meta http-equiv="content-type" content="text/html; charset=utf-8">

    
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1">

    <title> How Browsers Detect If You Are Offline &middot; Sadique Ali </title>

    
    <link rel="stylesheet" href="http://sdqali.in/css/poole.css">
    <link rel="stylesheet" href="http://sdqali.in/css/syntax.css">
    <link rel="stylesheet" href="http://sdqali.in/css/hyde.css">
    <link rel="stylesheet" href="http://sdqali.in/css/default.min.css">
    <link rel="stylesheet" href="http://sdqali.in/css/custom.css">
    <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=PT+Sans:400,400italic,700|Abril+Fatface">

    
    <link rel="apple-touch-icon" sizes="57x57" href="/apple-touch-icon-57x57.png">
    <link rel="apple-touch-icon" sizes="60x60" href="/apple-touch-icon-60x60.png">
    <link rel="apple-touch-icon" sizes="72x72" href="/apple-touch-icon-72x72.png">
    <link rel="apple-touch-icon" sizes="76x76" href="/apple-touch-icon-76x76.png">
    <link rel="apple-touch-icon" sizes="114x114" href="/apple-touch-icon-114x114.png">
    <link rel="apple-touch-icon" sizes="120x120" href="/apple-touch-icon-120x120.png">
    <link rel="apple-touch-icon" sizes="144x144" href="/apple-touch-icon-144x144.png">
    <link rel="apple-touch-icon" sizes="152x152" href="/apple-touch-icon-152x152.png">
    <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon-180x180.png">
    <link rel="icon" type="image/png" href="/favicon-32x32.png" sizes="32x32">
    <link rel="icon" type="image/png" href="/android-chrome-192x192.png" sizes="192x192">
    <link rel="icon" type="image/png" href="/favicon-96x96.png" sizes="96x96">
    <link rel="icon" type="image/png" href="/favicon-16x16.png" sizes="16x16">
    <link rel="manifest" href="/manifest.json">
    <link rel="mask-icon" href="/safari-pinned-tab.svg" color="#5bbad5">
    <meta name="msapplication-TileColor" content="#da532c">
    <meta name="msapplication-TileImage" content="/mstile-144x144.png">
    <meta name="theme-color" content="#ffffff">

    <script src="https://d26b395fwzu5fz.cloudfront.net/3.3.0/keen.min.js" type="text/javascript"></script>
    <script src="http://sdqali.in/js/parseuri.js" type="text/javascript"></script>
    <script src="http://sdqali.in/js/ua-parser.min.js" type="text/javascript"></script>
    <script src="http://sdqali.in/js/Math.uuid.js" type="text/javascript"></script>

    
    <link href="" rel="alternate" type="application/rss+xml" title="Sadique Ali" />

    <script type="text/javascript" src="http://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.0.0/highlight.min.js"></script>
    <script type="text/javascript">
      hljs.initHighlightingOnLoad();
    </script>

    <script type="text/javascript">
  var client = new Keen({
    projectId: "566f9f7a96773d75e098bb34", 
    writeKey: "5d41bf4e9b86ee088f2ae748d782f6e40501d9f1807e04cd3c2bea52c276f14416f585877c39785704bdd5407aae393cc8ad601646d2112f8293a0269145baebec15f48e073186173b9e6c82cd3767456296c77a46d23b827c82492116d919e8401dfa84c56f13adac91963575522314",   
    readKey: "57d95890c1893e97bb47ff02d5082242490a5f0585777e5f157ff3c5f01aca1c1e5bdaab91d874668b7154981d14dd5d73e3a54ef3360e93f29ea1b50b36b339e0e0fe063347fa6ce9bf9f1536752fa81bf2e12079a21e2e57312a55260403f09915e11455cb98e69a2dc9094c14184a"      
  });

var uri = parseUri(window.location.href);
var referrer = parseUri(document.referrer);
var uaParser = new UAParser();
client.addEvent("pagehit", {
  "url" : {
    "source" : uri.source,
    "protocol" : uri.protocol,
    "domain" : uri.host,
    "port" : uri.port,
    "path" : uri.path,
    "anchor" : uri.anchor
  },
  "user_agent" : {
    "browser" : uaParser.getBrowser(),
    "engine" : uaParser.getEngine(),
    "os" : uaParser.getOS()
  },
  referrer: {
    "source" : referrer.source,
    "protocol" : referrer.protocol,
    "domain" : referrer.host,
    "port" : referrer.port,
    "path" : referrer.path,
    "anchor" : referrer.anchor
  },
  "session_id" : Math.uuid(),
  "permanent_tracker" : Math.uuid()
});
</script>

  </head>


<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:site" content="@sdqali">
<meta name="twitter:creator" content="@sdqali">
<meta name="twitter:title" content="How Browsers Detect If You Are Offline">
<meta name="twitter:description" content="When I saw the newly released Heyoffline.js library, I was curious to see how it figured out if the user was online or not. This led me to the window.navigator.onLine API and how different browsers implement it. Chrome, Safari and Inernet Explorer 10 make sure that the API detects if the user is connected to a network, while Firefox changes this flag if and only if the user chooses the Work Offline option.">
<meta name="twitter:image" content="http://sdqali.in/map[feature:/images/threaded-blue-on-black-cropped.jpg]">

<meta property="og:title" content="How Browsers Detect If You Are Offline" />
<meta property="og:description" content="When I saw the newly released Heyoffline.js library, I was curious to see how it figured out if the user was online or not. This led me to the window.navigator.onLine API and how different browsers implement it. Chrome, Safari and Inernet Explorer 10 make sure that the API detects if the user is connected to a network, while Firefox changes this flag if and only if the user chooses the Work Offline option." itemprop="description"/>
<meta property="og:url" content="http://sdqali.in/blog/2012/11/22/how-browsers-detect-if-you-are-offline/" />
<meta property="og:image" content="http://sdqali.in/map[feature:/images/threaded-blue-on-black-cropped.jpg]" />
<body class="theme-base-0b">

<div class="sidebar">
  <div class="container sidebar-sticky">
    <div class="sidebar-about">
      <h1>
	<a href="/">Sadique Ali</a>
      </h1>
      <p class="lead">
       A blog about the Code I write and the Technologies I use. And other things that interest me. 
      </p>
    </div>

    <ul class="sidebar-nav">
      <li><a href="/">Home</a> </li>
      <li><a href="/blog/">Blog</a> </li>
      <li><a href="/about">About</a> </li>
      <li><a href="https://github.com/sdqali">GitHub</a> </li>
      <li><a href="https://twitter.com/sdqali">Twitter</a> </li>
      <li><a href="https://www.linkedin.com/in/sdqali">LinkedIn</a> </li>
      
    </ul>

    <p>&copy; 2015. All rights reserved. </p>
  </div>
</div>


<div class="content container" itemscope itemtype="http://schema.org/BlogPosting">
<meta itemscope itemprop="mainEntityOfPage"  itemType="https://schema.org/WebPage" itemid="http://sdqali.in/blog/2012/11/22/how-browsers-detect-if-you-are-offline/"/>
<meta itemprop="datePublished" content="2012-11-22 00:00:00 &#43;0000 UTC"/>
<meta itemprop="dateModified" content="2012-11-22 00:00:00 &#43;0000 UTC"/>

<div class="post">
  <h1 itemprop="headline">How Browsers Detect If You Are Offline</h1>
  <div class="author" itemprop="author" itemscope itemtype="https://schema.org/Person">
    By <span itemprop="name">Sadique Ali</span>
  </div>
  <span class="post-date">Thu, Nov 22, 2012</span>
      <p>When I saw the newly released
<a href="http://oskarkrawczyk.github.com/heyoffline.js/">Heyoffline.js</a> library,
I was curious to see how it figured out if the user was online or
not. This led me to the <code>window.navigator.onLine</code> <a href="https://developer.mozilla.org/en-US/docs/DOM/window.navigator.onLine">API</a> and how
different browsers implement it. Chrome, Safari and Inernet Explorer 10
make sure that the API detects if the user is connected to a network,
while Firefox changes this flag if and only if the user chooses the
<code>Work Offline</code> option. A detailed discussion of this difference in
implementation is available
<a href="http://schalk-neethling.com/2011/05/navigator-online-and-the-differing-implementations-of-a-standard/">here</a>.</p>

<p>While this is an interesting example of how despite the efforts put into
standardising specifications they get interpreted differently, I was
more interested in seeing how different browsers detect if the user is
offline or not.</p>

<p>I did some digging around and this is what I found:</p>

<ul>
<li>I expected Internet Explorer to use the <a href="http://blog.superuser.com/2011/05/16/windows-7-network-awareness/">Network Connectivity Status
Indicator</a>
service. It looks like that is not the case. Setting the registry
entry
<code>HKEY_LOCAL_MACHINESYSTEM\CurrentControlSet\Services\NlaSvc\Parameters\Internet
-&gt; EnableActiveProbing</code> to <code>0</code> did not seem to have any effect on
Explorer&rsquo;s ability to find if the user is online or not.</li>
<li>Google Chrome on Windows uses the <a href="&quot;http://msdn.microsoft.com/en-us/library/windows/desktop/ms741641(v=vs.85">Winsock API</a>.aspx&rdquo;) to detect if a network
is available. The relevant source code is
<a href="http://src.chromium.org/svn/trunk/src/net/base/network_change_notifier_win.cc">here</a>. Look
for the method <code>GetCurrentConnectionType()</code></li>
<li>Google Chrome on Linux uses a wrapper around NetworkManager&rsquo;s D-Bus
API. The code is
<a href="http://src.chromium.org/svn/trunk/src/net/base/network_change_notifier_linux.cc">here</a>.</li>
<li>Google Chrome on Mac tries to reach <code>0.0.0.0</code>. This can be seen
<a href="http://src.chromium.org/svn/trunk/src/net/base/network_change_notifier_mac.cc">here</a>. Look for the method <code>SetInitialConnectionType()</code>.</li>
</ul>

</div>
</div>

  </body>
</html>
