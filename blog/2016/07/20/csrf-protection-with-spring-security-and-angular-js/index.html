<!DOCTYPE html5>
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en-us" prefix="og: http://ogp.me/ns#">
  <head>

    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta content="Programming, Software Development, Java Development, Coding" name="keywords">
    <meta name="author" content="Sadique Ali">

    
    
      
    
    

    <title>CSRF Protection with Spring Security and Angular JS - {code that works} by Sadique Ali</title>

    
    
    

</head>

  <meta name="description" content="Both Spring Security and Angular JS provide support for CSRF protection. However, getting these to work together to provide protection from CSRF requires some non-obvious configuration. This blog post explains how to add CSRF protection to an application that uses Spring Security with an Angular JS front end." />
  
    <meta content="development" name="keywords">
  

  
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:site" content="@sdqali">
  <meta name="twitter:creator" content="@sdqali">
  <meta name="twitter:title" content="CSRF Protection with Spring Security and Angular JS">
  <meta name="twitter:description" content="Both Spring Security and Angular JS provide support for CSRF protection. However, getting these to work together to provide protection from CSRF requires some non-obvious configuration. This blog post explains how to add CSRF protection to an application that uses Spring Security with an Angular JS front end.">
  <meta name="twitter:image" content="https://sdqali.in/images/angular-spring-boot.png">

  <meta property="og:title" content="CSRF Protection with Spring Security and Angular JS" />
  <meta property="og:description" content="Both Spring Security and Angular JS provide support for CSRF protection. However, getting these to work together to provide protection from CSRF requires some non-obvious configuration. This blog post explains how to add CSRF protection to an application that uses Spring Security with an Angular JS front end." itemprop="description"/>
  <meta property="og:url" content="https://sdqali.in/blog/2016/07/20/csrf-protection-with-spring-security-and-angular-js/" />
  <meta property="og:image" content="https://sdqali.in/images/angular-spring-boot.png" />
  <body>

    <nav itemscope="itemscope" itemtype="http://schema.org/SiteNavigationElement">
  <ul >
    <li aria-hidden="true"><a href="/">Home</a> </li>
    <li><a href="/blog/">Blog</a> </li>
    <li><a href="/about">About</a> </li>
    <li><a href="/index.xml">Atom Feed</a> </li>
    <li><a href="https://github.com/sdqali">GitHub</a> </li>
    <li><a href="https://twitter.com/sdqali">Twitter</a> </li>
    <li><a href="https://www.linkedin.com/in/sdqali">LinkedIn</a> </li>
  </ul>
</nav>




		
		
		<header itemscope="itemscope" itemtype="http://schema.org/WPHeader">
				<div >
					<h1> CSRF Protection with Spring Security and Angular JS</h1>
					<span >Wed, Jul 20, 2016</span>
					<div class="tag-list">
						<span  aria-hidden="true"></span>
						
						
						
					</div>
				</div>
    </header>


    
    <article>
      <div itemprop="mainContentOfPage"
           itemscope="itemscope" itemtype="http://schema.org/WebPageElement">
        <div>
          <p>Both Spring Security and Angular JS provide support for CSRF protection. However, getting these to work together to provide protection from CSRF requires some non-obvious configuration. This blog post explains how to add CSRF protection to an application that uses Spring Security with an Angular JS front end.</p>

<p>Cross-Site Request Forgery (CSRF) <sup class="footnote-ref" id="fnref:1"><a href="#fn:1">1</a></sup> is an attack that forces an end user to execute unwanted actions on a web application in which they&rsquo;re currently authenticated. This blog post implements the CSRF token part of the protection described by OWASP. The application still needs to have protection to enforce the right Origin for requests.</p>

<h3 id="front-end">Front end</h3>

<p>For this example, we will build a simple Spring Boot application with an Angular front end. The front end is based on the application we built for the <a href="/blog/2016/07/02/jwt-authentication-with-spring-web-part-1/">series</a> on authentication with JWT. The changes are in how the initial authentication is done - we will be using Basic Auth in this example to perform the initial authentication.</p>

<p>This involves changing the <code>LoginService</code> to this:</p>
<div class="highlight"><pre style="background-color:#f0f3f3;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-javascript" data-lang="javascript">(<span style="color:#069;font-weight:bold">function</span>(angular) {
  <span style="color:#069;font-weight:bold">var</span> LoginFactory <span style="color:#555">=</span> <span style="color:#069;font-weight:bold">function</span>($http) {
    <span style="color:#069;font-weight:bold">return</span> <span style="color:#069;font-weight:bold">function</span>(credentials, success, error) {
      $http({
        method<span style="color:#555">:</span> <span style="color:#c30">&#39;POST&#39;</span>,
        url<span style="color:#555">:</span> <span style="color:#c30">&#39;/login&#39;</span>,
        headers<span style="color:#555">:</span> {
          Authorization<span style="color:#555">:</span> <span style="color:#c30">&#34;Basic &#34;</span> <span style="color:#555">+</span> btoa(credentials.username <span style="color:#555">+</span> <span style="color:#c30">&#34;:&#34;</span> <span style="color:#555">+</span> credentials.password)
        }
      }).then(<span style="color:#069;font-weight:bold">function</span> (resp) {
        success(resp.data, resp.headers())
      }, error);
    };
  };

  LoginFactory.$inject <span style="color:#555">=</span> [<span style="color:#c30">&#39;$http&#39;</span>];
  angular.module(<span style="color:#c30">&#39;jwtDemo.services&#39;</span>).factory(<span style="color:#c30">&#39;Login&#39;</span>, LoginFactory);

  <span style="color:#069;font-weight:bold">var</span> HelloFactory <span style="color:#555">=</span> <span style="color:#069;font-weight:bold">function</span>($resource) {
    <span style="color:#069;font-weight:bold">return</span> $resource(<span style="color:#c30">&#39;/hello&#39;</span>, {}, {
      hello<span style="color:#555">:</span> {
        method<span style="color:#555">:</span> <span style="color:#c30">&#39;GET&#39;</span>
      }
    });
  };

  HelloFactory.$inject <span style="color:#555">=</span> [<span style="color:#c30">&#39;$resource&#39;</span>];
  angular.module(<span style="color:#c30">&#39;jwtDemo.services&#39;</span>).factory(<span style="color:#c30">&#39;Hello&#39;</span>, HelloFactory);}(angular));
</code></pre></div>
<p>And the controllers are changed to use these services.</p>
<div class="highlight"><pre style="background-color:#f0f3f3;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-javascript" data-lang="javascript">(<span style="color:#069;font-weight:bold">function</span>(angular) {
  <span style="color:#069;font-weight:bold">var</span> LoginController <span style="color:#555">=</span> <span style="color:#069;font-weight:bold">function</span>($scope, $localStorage, $http, $location, Login) {
    $scope.login <span style="color:#555">=</span> <span style="color:#069;font-weight:bold">function</span>(username, password) {
      <span style="color:#069;font-weight:bold">new</span> Login({username<span style="color:#555">:</span> username, password<span style="color:#555">:</span> password},
          <span style="color:#069;font-weight:bold">function</span> (data, headers) {
            $localStorage.user <span style="color:#555">=</span> data.user;
            $localStorage.authToken <span style="color:#555">=</span> headers[<span style="color:#c30">&#39;x-auth-token&#39;</span>];
            $http.defaults.headers.common[<span style="color:#c30">&#39;x-auth-token&#39;</span>] <span style="color:#555">=</span> headers[<span style="color:#c30">&#39;x-auth-token&#39;</span>];
            $location.path(<span style="color:#c30">&#34;/&#34;</span>);
          }, <span style="color:#069;font-weight:bold">function</span> (error) {
            console.log(error);
          });
    };

    $scope.logout <span style="color:#555">=</span> <span style="color:#069;font-weight:bold">function</span> () {
      <span style="color:#069;font-weight:bold">delete</span> $localStorage.user;
      <span style="color:#069;font-weight:bold">delete</span> $localStorage.authToken;
      $http.defaults.headers.common <span style="color:#555">=</span> {};
    }

    $scope.logout();
  };

  LoginController.$inject <span style="color:#555">=</span> [<span style="color:#c30">&#39;$scope&#39;</span>, <span style="color:#c30">&#39;$localStorage&#39;</span>, <span style="color:#c30">&#39;$http&#39;</span>, <span style="color:#c30">&#39;$location&#39;</span>,<span style="color:#c30">&#39;Login&#39;</span>];
  angular.module(<span style="color:#c30">&#34;jwtDemo.controllers&#34;</span>).controller(<span style="color:#c30">&#34;LoginController&#34;</span>, LoginController);


  <span style="color:#069;font-weight:bold">var</span> ProfileController <span style="color:#555">=</span> <span style="color:#069;font-weight:bold">function</span> ($scope, $localStorage, Hello) {
    $scope.profile <span style="color:#555">=</span> $localStorage.user;
    <span style="color:#069;font-weight:bold">new</span> Hello().$hello(<span style="color:#069;font-weight:bold">function</span> (resp, headers) {
      $scope.greeting <span style="color:#555">=</span> resp.message;
    }, <span style="color:#069;font-weight:bold">function</span> (error) {
      console.log(error);
    })
  };
  ProfileController.inject <span style="color:#555">=</span> [<span style="color:#c30">&#39;$scope&#39;</span>, <span style="color:#c30">&#39;$localStorage&#39;</span>, <span style="color:#c30">&#39;Hello&#39;</span>];
  angular.module(<span style="color:#c30">&#34;jwtDemo.controllers&#34;</span>).controller(<span style="color:#c30">&#34;ProfileController&#34;</span>, ProfileController);
  }(angular));
</code></pre></div>
<p>It can be noted that there are no CSRF specific code in there. We will be relying on Angular&rsquo;s CSRF (or XSRF as Angular refers to it) protection.</p>

<h3 id="the-back-end">The back end</h3>

<p>The main API returns a greeting:</p>
<div class="highlight"><pre style="background-color:#f0f3f3;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-java" data-lang="java"><span style="color:#99f">@RestController</span>
<span style="color:#99f">@RequestMapping</span><span style="color:#555">(</span><span style="color:#c30">&#34;/hello&#34;</span><span style="color:#555">)</span>
<span style="color:#069;font-weight:bold">public</span> <span style="color:#069;font-weight:bold">class</span> <span style="color:#0a8;font-weight:bold">HelloController</span> <span style="color:#555">{</span>
  <span style="color:#99f">@RequestMapping</span><span style="color:#555">(</span>method <span style="color:#555">=</span> GET<span style="color:#555">,</span>
      path <span style="color:#555">=</span> <span style="color:#c30">&#34;&#34;</span><span style="color:#555">,</span>
      produces <span style="color:#555">=</span> APPLICATION_JSON_VALUE<span style="color:#555">)</span>
  <span style="color:#069;font-weight:bold">public</span> Map<span style="color:#555">&lt;</span>String<span style="color:#555">,</span> String<span style="color:#555">&gt;</span> <span style="color:#c0f">hello</span><span style="color:#555">()</span> <span style="color:#555">{</span>
    <span style="color:#069;font-weight:bold">return</span> Collections<span style="color:#555">.</span><span style="color:#309">singletonMap</span><span style="color:#555">(</span><span style="color:#c30">&#34;message&#34;</span><span style="color:#555">,</span> <span style="color:#c30">&#34;hello&#34;</span><span style="color:#555">);</span>
  <span style="color:#555">}</span>
<span style="color:#555">}</span></code></pre></div>
<p>We also have an end point that clients can authenticate against and it returns the currently authenticated user:</p>
<div class="highlight"><pre style="background-color:#f0f3f3;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-java" data-lang="java"><span style="color:#99f">@RestController</span>
<span style="color:#99f">@RequestMapping</span><span style="color:#555">(</span><span style="color:#c30">&#34;/login&#34;</span><span style="color:#555">)</span>
<span style="color:#069;font-weight:bold">public</span> <span style="color:#069;font-weight:bold">class</span> <span style="color:#0a8;font-weight:bold">LoginController</span> <span style="color:#555">{</span>
  <span style="color:#99f">@RequestMapping</span><span style="color:#555">(</span>method <span style="color:#555">=</span> POST<span style="color:#555">,</span>
      path <span style="color:#555">=</span> <span style="color:#c30">&#34;&#34;</span><span style="color:#555">,</span>
      produces <span style="color:#555">=</span> APPLICATION_JSON_VALUE<span style="color:#555">)</span>
  <span style="color:#069;font-weight:bold">public</span> Map<span style="color:#555">&lt;</span>String<span style="color:#555">,</span> Object<span style="color:#555">&gt;</span> <span style="color:#c0f">login</span><span style="color:#555">(</span>Authentication auth<span style="color:#555">)</span> <span style="color:#555">{</span>
    <span style="color:#069;font-weight:bold">return</span> Collections<span style="color:#555">.</span><span style="color:#309">singletonMap</span><span style="color:#555">(</span><span style="color:#c30">&#34;user&#34;</span><span style="color:#555">,</span> auth<span style="color:#555">.</span><span style="color:#309">getName</span><span style="color:#555">());</span>
  <span style="color:#555">}</span>
<span style="color:#555">}</span></code></pre></div>
<h3 id="security">Security</h3>

<p>In this example, we will be using an in-memory authentication. We will also be using a header based session instead of a Cookie based session by wiring up <code>HeaderHttpSessionStrategy</code>. Sessions are stored in-memory using <code>MapSessionRepository</code>. We also secure all end points except the front end components and the <code>/login</code> end point.</p>
<div class="highlight"><pre style="background-color:#f0f3f3;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-java" data-lang="java"><span style="color:#99f">@EnableWebSecurity</span>
<span style="color:#99f">@Configuration</span>
<span style="color:#99f">@EnableSpringHttpSession</span>
<span style="color:#069;font-weight:bold">public</span> <span style="color:#069;font-weight:bold">class</span> <span style="color:#0a8;font-weight:bold">SecurityConfig</span> <span style="color:#069;font-weight:bold">extends</span> WebSecurityConfigurerAdapter <span style="color:#555">{</span>
  <span style="color:#99f">@Override</span>
  <span style="color:#069;font-weight:bold">protected</span> <span style="color:#078;font-weight:bold">void</span> <span style="color:#c0f">configure</span><span style="color:#555">(</span>HttpSecurity http<span style="color:#555">)</span> <span style="color:#069;font-weight:bold">throws</span> Exception <span style="color:#555">{</span>
    String<span style="color:#555">[]</span> patterns <span style="color:#555">=</span> <span style="color:#069;font-weight:bold">new</span> String<span style="color:#555">[]</span> <span style="color:#555">{</span>
        <span style="color:#c30">&#34;/&#34;</span><span style="color:#555">,</span>
        <span style="color:#c30">&#34;/login&#34;</span><span style="color:#555">,</span>
        <span style="color:#c30">&#34;/bower_components/**/*&#34;</span><span style="color:#555">,</span>
        <span style="color:#c30">&#34;/app/**/*&#34;</span><span style="color:#555">,</span>
        <span style="color:#c30">&#34;/index.html&#34;</span><span style="color:#555">,</span>
        <span style="color:#c30">&#34;/home.html&#34;</span><span style="color:#555">,</span>
        <span style="color:#c30">&#34;/signin.html&#34;</span><span style="color:#555">,</span>
        <span style="color:#c30">&#34;/favicon.ico&#34;</span>
    <span style="color:#555">};</span>

    http
        <span style="color:#555">.</span><span style="color:#309">authorizeRequests</span><span style="color:#555">()</span>
        <span style="color:#555">.</span><span style="color:#309">antMatchers</span><span style="color:#555">(</span>patterns<span style="color:#555">)</span>
        <span style="color:#555">.</span><span style="color:#309">permitAll</span><span style="color:#555">()</span>
        <span style="color:#555">.</span><span style="color:#309">antMatchers</span><span style="color:#555">(</span><span style="color:#c30">&#34;/hello/**&#34;</span><span style="color:#555">)</span>
        <span style="color:#555">.</span><span style="color:#309">hasRole</span><span style="color:#555">(</span><span style="color:#c30">&#34;USER&#34;</span><span style="color:#555">)</span>
        <span style="color:#555">.</span><span style="color:#309">and</span><span style="color:#555">()</span>
        <span style="color:#555">.</span><span style="color:#309">csrf</span><span style="color:#555">()</span>
        <span style="color:#555">.</span><span style="color:#309">disable</span><span style="color:#555">()</span>
        <span style="color:#555">.</span><span style="color:#309">httpBasic</span><span style="color:#555">();</span>
  <span style="color:#555">}</span>

  <span style="color:#99f">@Autowired</span>
  <span style="color:#069;font-weight:bold">public</span> <span style="color:#078;font-weight:bold">void</span> <span style="color:#c0f">configureGlobal</span><span style="color:#555">(</span>AuthenticationManagerBuilder auth<span style="color:#555">)</span> <span style="color:#069;font-weight:bold">throws</span> Exception <span style="color:#555">{</span>
    auth
        <span style="color:#555">.</span><span style="color:#309">inMemoryAuthentication</span><span style="color:#555">()</span>
        <span style="color:#555">.</span><span style="color:#309">withUser</span><span style="color:#555">(</span><span style="color:#c30">&#34;user&#34;</span><span style="color:#555">).</span><span style="color:#309">password</span><span style="color:#555">(</span><span style="color:#c30">&#34;password&#34;</span><span style="color:#555">).</span><span style="color:#309">roles</span><span style="color:#555">(</span><span style="color:#c30">&#34;USER&#34;</span><span style="color:#555">);</span>
  <span style="color:#555">}</span>

  <span style="color:#99f">@Bean</span>
  <span style="color:#069;font-weight:bold">public</span> SessionRepository <span style="color:#c0f">sessionRepository</span><span style="color:#555">()</span> <span style="color:#555">{</span>
    <span style="color:#069;font-weight:bold">return</span> <span style="color:#069;font-weight:bold">new</span> MapSessionRepository<span style="color:#555">();</span>
  <span style="color:#555">}</span>

  <span style="color:#99f">@Bean</span>
  <span style="color:#069;font-weight:bold">public</span> HeaderHttpSessionStrategy <span style="color:#c0f">sessionStrategy</span><span style="color:#555">()</span> <span style="color:#555">{</span>
    <span style="color:#069;font-weight:bold">return</span> <span style="color:#069;font-weight:bold">new</span> HeaderHttpSessionStrategy<span style="color:#555">();</span>
  <span style="color:#555">}</span>
<span style="color:#555">}</span></code></pre></div>
<p>With this in place, access to the end point <code>/hello</code> is not permitted unless authenticated.</p>
<div class="highlight"><pre style="background-color:#f0f3f3;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">$ curl -s -X GET <span style="color:#c30">&#34;http://localhost:8080/hello&#34;</span> | jq .
<span style="color:#555">{</span>
  <span style="color:#c30">&#34;timestamp&#34;</span>: <span style="color:#f60">1469068247812</span>,
  <span style="color:#c30">&#34;status&#34;</span>: <span style="color:#f60">401</span>,
  <span style="color:#c30">&#34;error&#34;</span>: <span style="color:#c30">&#34;Unauthorized&#34;</span>,
  <span style="color:#c30">&#34;message&#34;</span>: <span style="color:#c30">&#34;Full authentication is required to access this resource&#34;</span>,
  <span style="color:#c30">&#34;path&#34;</span>: <span style="color:#c30">&#34;/hello&#34;</span>
<span style="color:#555">}</span>

$ curl -s -v -X POST <span style="color:#c30">&#34;http://localhost:8080/login&#34;</span> -uuser:password | jq .
*   Trying ::1...
* Connected to localhost <span style="color:#555">(</span>::1<span style="color:#555">)</span> port <span style="color:#f60">8080</span> <span style="color:#555">(</span><span style="color:#09f;font-style:italic">#0)</span>
* Server auth using Basic with user <span style="color:#c30">&#39;user&#39;</span>
&gt; POST /login HTTP/1.1
&gt; Host: localhost:8080
&gt; Authorization: Basic <span style="color:#033">dXNlcjpwYXNzd29yZA</span><span style="color:#555">==</span>
&gt; User-Agent: curl/7.43.0
&gt; Accept: */*
&gt;
&lt; HTTP/1.1 <span style="color:#f60">200</span> OK
&lt; Server: Apache-Coyote/1.1
&lt; X-Content-Type-Options: nosniff
&lt; X-XSS-Protection: <span style="color:#f60">1</span>; <span style="color:#033">mode</span><span style="color:#555">=</span>block
&lt; Cache-Control: no-cache, no-store, max-age<span style="color:#555">=</span><span style="color:#f60">0</span>, must-revalidate
&lt; Pragma: no-cache
&lt; Expires: <span style="color:#f60">0</span>
&lt; X-Frame-Options: DENY
&lt; x-auth-token: 4ec4c614-0dc8-4e64-afa6-bd0ac03517b5
&lt; Content-Type: application/json;<span style="color:#033">charset</span><span style="color:#555">=</span>UTF-8
&lt; Transfer-Encoding: chunked
&lt; Date: Thu, <span style="color:#f60">21</span> Jul <span style="color:#f60">2016</span> <span style="color:#f60">02</span>:31:10 GMT
&lt;
<span style="color:#555">{</span> <span style="color:#555">[</span><span style="color:#f60">18</span> bytes data<span style="color:#555">]</span>
* Connection <span style="color:#09f;font-style:italic">#0 to host localhost left intact</span>
<span style="color:#555">{</span>
  <span style="color:#c30">&#34;user&#34;</span>: <span style="color:#c30">&#34;user&#34;</span>
<span style="color:#555">}</span>

$ curl -s -X GET <span style="color:#c30">&#34;http://localhost:8080/hello&#34;</span> -H <span style="color:#c30">&#34;x-auth-token: 4ec4c614-0dc8-4e64-afa6-bd0ac03517b5&#34;</span> | jq .
<span style="color:#555">{</span>
  <span style="color:#c30">&#34;message&#34;</span>: <span style="color:#c30">&#34;hello&#34;</span>
<span style="color:#555">}</span></code></pre></div>
<h3 id="enabling-csrf-protection">Enabling CSRF protection</h3>

<p>In Spring Security, CSRF protection can be enabled by replacing <code>csrf().disable()</code> with <code>.csrf()</code>.</p>
<div class="highlight"><pre style="background-color:#f0f3f3;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-java" data-lang="java">    http
        <span style="color:#555">.</span><span style="color:#309">authorizeRequests</span><span style="color:#555">()</span>
        <span style="color:#555">.</span><span style="color:#309">antMatchers</span><span style="color:#555">(</span>patterns<span style="color:#555">)</span>
        <span style="color:#555">.</span><span style="color:#309">permitAll</span><span style="color:#555">()</span>
        <span style="color:#555">.</span><span style="color:#309">antMatchers</span><span style="color:#555">(</span><span style="color:#c30">&#34;/hello/**&#34;</span><span style="color:#555">)</span>
        <span style="color:#555">.</span><span style="color:#309">hasRole</span><span style="color:#555">(</span><span style="color:#c30">&#34;USER&#34;</span><span style="color:#555">)</span>
        <span style="color:#555">.</span><span style="color:#309">and</span><span style="color:#555">()</span>
        <span style="color:#555">.</span><span style="color:#309">csrf</span><span style="color:#555">()</span>
        <span style="color:#555">.</span><span style="color:#309">and</span><span style="color:#555">()</span>
        <span style="color:#555">.</span><span style="color:#309">httpBasic</span><span style="color:#555">();</span></code></pre></div>
<p>With this in place however, we notice that all end points, including static assets and the login end point need CSRF protection tokens to access.</p>
<div class="highlight"><pre style="background-color:#f0f3f3;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">$ curl -s -X POST <span style="color:#c30">&#34;http://localhost:8080/login&#34;</span> -uuser:password | jq .
<span style="color:#555">{</span>
  <span style="color:#c30">&#34;timestamp&#34;</span>: <span style="color:#f60">1469068611814</span>,
  <span style="color:#c30">&#34;status&#34;</span>: <span style="color:#f60">403</span>,
  <span style="color:#c30">&#34;error&#34;</span>: <span style="color:#c30">&#34;Forbidden&#34;</span>,
  <span style="color:#c30">&#34;message&#34;</span>: <span style="color:#c30">&#34;Expected CSRF token not found. Has your session expired?&#34;</span>,
  <span style="color:#c30">&#34;path&#34;</span>: <span style="color:#c30">&#34;/login&#34;</span>
<span style="color:#555">}</span></code></pre></div>
<h3 id="protecting-urls-selectively">Protecting URLs selectively</h3>

<p>We want a mechanism to specify a list of URL patterns for which CSRF protection need to be turned OFF. Spring Security provides a <code>requireCsrfProtectionMatcher</code> method. With this, we will add a matcher that returns false when any of the URL patters we have matches the current request&rsquo;s path.</p>
<div class="highlight"><pre style="background-color:#f0f3f3;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-java" data-lang="java">http
        <span style="color:#555">.</span><span style="color:#309">authorizeRequests</span><span style="color:#555">()</span>
        <span style="color:#555">.</span><span style="color:#309">antMatchers</span><span style="color:#555">(</span>patterns<span style="color:#555">)</span>
        <span style="color:#555">.</span><span style="color:#309">permitAll</span><span style="color:#555">()</span>
        <span style="color:#555">.</span><span style="color:#309">antMatchers</span><span style="color:#555">(</span><span style="color:#c30">&#34;/hello/**&#34;</span><span style="color:#555">)</span>
        <span style="color:#555">.</span><span style="color:#309">hasRole</span><span style="color:#555">(</span><span style="color:#c30">&#34;USER&#34;</span><span style="color:#555">)</span>
        <span style="color:#555">.</span><span style="color:#309">and</span><span style="color:#555">()</span>
        <span style="color:#555">.</span><span style="color:#309">csrf</span><span style="color:#555">()</span>
        <span style="color:#555">.</span><span style="color:#309">requireCsrfProtectionMatcher</span><span style="color:#555">(</span><span style="color:#069;font-weight:bold">new</span> NoAntPathRequestMatcher<span style="color:#555">(</span>patterns<span style="color:#555">))</span>
        <span style="color:#555">.</span><span style="color:#309">and</span><span style="color:#555">()</span>
        <span style="color:#555">.</span><span style="color:#309">httpBasic</span><span style="color:#555">();</span></code></pre></div>
<p>The <code>NoAntPathRequestMatcher</code> can be implemented as a combination of two request matchers provided by Spring - <code>NegatedRequestMatcher</code> and <code>AndRequestMatcher</code>:</p>
<div class="highlight"><pre style="background-color:#f0f3f3;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-java" data-lang="java"><span style="color:#069;font-weight:bold">public</span> <span style="color:#069;font-weight:bold">class</span> <span style="color:#0a8;font-weight:bold">NoAntPathRequestMatcher</span> <span style="color:#069;font-weight:bold">implements</span> RequestMatcher <span style="color:#555">{</span>
  <span style="color:#069;font-weight:bold">private</span> <span style="color:#069;font-weight:bold">final</span> AndRequestMatcher andRequestMatcher<span style="color:#555">;</span>

  <span style="color:#069;font-weight:bold">public</span> <span style="color:#c0f">NoAntPathRequestMatcher</span><span style="color:#555">(</span>String<span style="color:#555">[]</span> patterns<span style="color:#555">)</span> <span style="color:#555">{</span>
    List<span style="color:#555">&lt;</span>RequestMatcher<span style="color:#555">&gt;</span> requestMatchers <span style="color:#555">=</span> Arrays<span style="color:#555">.</span><span style="color:#309">asList</span><span style="color:#555">(</span>patterns<span style="color:#555">)</span>
        <span style="color:#555">.</span><span style="color:#309">stream</span><span style="color:#555">()</span>
        <span style="color:#555">.</span><span style="color:#309">map</span><span style="color:#555">(</span>p <span style="color:#555">-&gt;</span> <span style="color:#069;font-weight:bold">new</span> NegatedRequestMatcher<span style="color:#555">(</span><span style="color:#069;font-weight:bold">new</span> AntPathRequestMatcher<span style="color:#555">(</span>p<span style="color:#555">)))</span>
        <span style="color:#555">.</span><span style="color:#309">collect</span><span style="color:#555">(</span>Collectors<span style="color:#555">.</span><span style="color:#309">toList</span><span style="color:#555">());</span>

    andRequestMatcher <span style="color:#555">=</span> <span style="color:#069;font-weight:bold">new</span> AndRequestMatcher<span style="color:#555">(</span>requestMatchers<span style="color:#555">);</span>
  <span style="color:#555">}</span>

  <span style="color:#99f">@Override</span>
  <span style="color:#069;font-weight:bold">public</span> <span style="color:#078;font-weight:bold">boolean</span> <span style="color:#c0f">matches</span><span style="color:#555">(</span>HttpServletRequest request<span style="color:#555">)</span> <span style="color:#555">{</span>
    <span style="color:#069;font-weight:bold">return</span> andRequestMatcher<span style="color:#555">.</span><span style="color:#309">matches</span><span style="color:#555">(</span>request<span style="color:#555">);</span>
  <span style="color:#555">}</span>
<span style="color:#555">}</span></code></pre></div>
<p>With this in place, we should be able to authenticate.</p>
<div class="highlight"><pre style="background-color:#f0f3f3;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">$ curl -s -v -X POST <span style="color:#c30">&#34;http://localhost:8080/login&#34;</span> -uuser:password | jq .
*   Trying ::1...
* Connected to localhost <span style="color:#555">(</span>::1<span style="color:#555">)</span> port <span style="color:#f60">8080</span> <span style="color:#555">(</span><span style="color:#09f;font-style:italic">#0)</span>
* Server auth using Basic with user <span style="color:#c30">&#39;user&#39;</span>
&gt; POST /login HTTP/1.1
&gt; Host: localhost:8080
&gt; Authorization: Basic <span style="color:#033">dXNlcjpwYXNzd29yZA</span><span style="color:#555">==</span>
&gt; User-Agent: curl/7.43.0
&gt; Accept: */*
&gt;
&lt; HTTP/1.1 <span style="color:#f60">200</span> OK
&lt; Server: Apache-Coyote/1.1
&lt; X-Content-Type-Options: nosniff
&lt; X-XSS-Protection: <span style="color:#f60">1</span>; <span style="color:#033">mode</span><span style="color:#555">=</span>block
&lt; Cache-Control: no-cache, no-store, max-age<span style="color:#555">=</span><span style="color:#f60">0</span>, must-revalidate
&lt; Pragma: no-cache
&lt; Expires: <span style="color:#f60">0</span>
&lt; X-Frame-Options: DENY
&lt; x-auth-token: c5af3ea9-e3f8-4425-a6e8-de35588af0ca
&lt; Content-Type: application/json;<span style="color:#033">charset</span><span style="color:#555">=</span>UTF-8
&lt; Transfer-Encoding: chunked
&lt; Date: Thu, <span style="color:#f60">21</span> Jul <span style="color:#f60">2016</span> <span style="color:#f60">02</span>:44:28 GMT
&lt;
<span style="color:#555">{</span> <span style="color:#555">[</span><span style="color:#f60">18</span> bytes data<span style="color:#555">]</span>
* Connection <span style="color:#09f;font-style:italic">#0 to host localhost left intact</span>
<span style="color:#555">{</span>
  <span style="color:#c30">&#34;user&#34;</span>: <span style="color:#c30">&#34;user&#34;</span>
<span style="color:#555">}</span></code></pre></div>
<p>But we do not see anything in the response that tells the client what the token allocated to it for the current session is. This is because Spring Security&rsquo;s CSRF protection by default provides enforcement and allocation of tokens, but it does not expose the token granted to the client out of the box.</p>

<h3 id="granting-csrf-token-to-the-client">Granting CSRF Token to the client</h3>

<p>One way to grant the client the CSRF token allocated to the current session will be to add a filter that sets the token as a Cookie once it is available. For this, we will add a filter immediately after the session is assigned by Spring Security&rsquo;s <code>SessionManagementFilter</code>.</p>
<div class="highlight"><pre style="background-color:#f0f3f3;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-java" data-lang="java">    http
        <span style="color:#555">.</span><span style="color:#309">authorizeRequests</span><span style="color:#555">()</span>
        <span style="color:#555">.</span><span style="color:#309">antMatchers</span><span style="color:#555">(</span>patterns<span style="color:#555">)</span>
        <span style="color:#555">.</span><span style="color:#309">permitAll</span><span style="color:#555">()</span>
        <span style="color:#555">.</span><span style="color:#309">antMatchers</span><span style="color:#555">(</span><span style="color:#c30">&#34;/hello/**&#34;</span><span style="color:#555">)</span>
        <span style="color:#555">.</span><span style="color:#309">hasRole</span><span style="color:#555">(</span><span style="color:#c30">&#34;USER&#34;</span><span style="color:#555">)</span>
        <span style="color:#555">.</span><span style="color:#309">and</span><span style="color:#555">()</span>
        <span style="color:#555">.</span><span style="color:#309">csrf</span><span style="color:#555">()</span>
        <span style="color:#555">.</span><span style="color:#309">requireCsrfProtectionMatcher</span><span style="color:#555">(</span>csrfProtectionMatcher<span style="color:#555">(</span>patterns<span style="color:#555">))</span>
        <span style="color:#555">.</span><span style="color:#309">and</span><span style="color:#555">()</span>
        <span style="color:#555">.</span><span style="color:#309">httpBasic</span><span style="color:#555">()</span>
        <span style="color:#555">.</span><span style="color:#309">and</span><span style="color:#555">()</span>
        <span style="color:#555">.</span><span style="color:#309">addFilterAfter</span><span style="color:#555">(</span><span style="color:#069;font-weight:bold">new</span> CsrfGrantingFilter<span style="color:#555">(),</span> SessionManagementFilter<span style="color:#555">.</span><span style="color:#309">class</span><span style="color:#555">);</span></code></pre></div>
<p>The filter is implemented as follows:</p>
<div class="highlight"><pre style="background-color:#f0f3f3;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-java" data-lang="java"><span style="color:#069;font-weight:bold">public</span> <span style="color:#069;font-weight:bold">class</span> <span style="color:#0a8;font-weight:bold">CsrfGrantingFilter</span> <span style="color:#069;font-weight:bold">implements</span> Filter <span style="color:#555">{</span>
  <span style="color:#99f">@Override</span>
  <span style="color:#069;font-weight:bold">public</span> <span style="color:#078;font-weight:bold">void</span> <span style="color:#c0f">init</span><span style="color:#555">(</span>FilterConfig filterConfig<span style="color:#555">)</span> <span style="color:#069;font-weight:bold">throws</span> ServletException <span style="color:#555">{}</span>

  <span style="color:#99f">@Override</span>
  <span style="color:#069;font-weight:bold">public</span> <span style="color:#078;font-weight:bold">void</span> <span style="color:#c0f">doFilter</span><span style="color:#555">(</span>ServletRequest servletRequest<span style="color:#555">,</span> ServletResponse servletResponse<span style="color:#555">,</span> FilterChain filterChain<span style="color:#555">)</span>
      <span style="color:#069;font-weight:bold">throws</span> IOException<span style="color:#555">,</span> ServletException <span style="color:#555">{</span>
    CsrfToken csrf <span style="color:#555">=</span> <span style="color:#555">(</span>CsrfToken<span style="color:#555">)</span> servletRequest<span style="color:#555">.</span><span style="color:#309">getAttribute</span><span style="color:#555">(</span>CsrfToken<span style="color:#555">.</span><span style="color:#309">class</span><span style="color:#555">.</span><span style="color:#309">getName</span><span style="color:#555">());</span>
    String token <span style="color:#555">=</span> csrf<span style="color:#555">.</span><span style="color:#309">getToken</span><span style="color:#555">();</span>
    <span style="color:#069;font-weight:bold">if</span> <span style="color:#555">(</span>token <span style="color:#555">!=</span> <span style="color:#069;font-weight:bold">null</span> <span style="color:#555">&amp;&amp;</span> isAuthenticating<span style="color:#555">(</span>servletRequest<span style="color:#555">))</span> <span style="color:#555">{</span>
      HttpServletResponse response <span style="color:#555">=</span> <span style="color:#555">(</span>HttpServletResponse<span style="color:#555">)</span> servletResponse<span style="color:#555">;</span>
      Cookie cookie <span style="color:#555">=</span> <span style="color:#069;font-weight:bold">new</span> Cookie<span style="color:#555">(</span><span style="color:#c30">&#34;CSRF-TOKEN&#34;</span><span style="color:#555">,</span> token<span style="color:#555">);</span>
      cookie<span style="color:#555">.</span><span style="color:#309">setPath</span><span style="color:#555">(</span><span style="color:#c30">&#34;/&#34;</span><span style="color:#555">);</span>
      response<span style="color:#555">.</span><span style="color:#309">addCookie</span><span style="color:#555">(</span>cookie<span style="color:#555">);</span>
    <span style="color:#555">}</span>
    filterChain<span style="color:#555">.</span><span style="color:#309">doFilter</span><span style="color:#555">(</span>servletRequest<span style="color:#555">,</span> servletResponse<span style="color:#555">);</span>
  <span style="color:#555">}</span>

  <span style="color:#069;font-weight:bold">private</span> <span style="color:#078;font-weight:bold">boolean</span> <span style="color:#c0f">isAuthenticating</span><span style="color:#555">(</span>ServletRequest servletRequest<span style="color:#555">)</span> <span style="color:#555">{</span>
    HttpServletRequest request <span style="color:#555">=</span> <span style="color:#555">(</span>HttpServletRequest<span style="color:#555">)</span> servletRequest<span style="color:#555">;</span>
    <span style="color:#069;font-weight:bold">return</span> request<span style="color:#555">.</span><span style="color:#309">getRequestURI</span><span style="color:#555">().</span><span style="color:#309">equals</span><span style="color:#555">(</span><span style="color:#c30">&#34;/login&#34;</span><span style="color:#555">);</span>
  <span style="color:#555">}</span>

  <span style="color:#99f">@Override</span>
  <span style="color:#069;font-weight:bold">public</span> <span style="color:#078;font-weight:bold">void</span> <span style="color:#c0f">destroy</span><span style="color:#555">()</span> <span style="color:#555">{}</span>
<span style="color:#555">}</span></code></pre></div>
<p>The filter checks to see if the current request has a CSRF token set on it by Spring Security&rsquo;s <code>CsrfFilter</code> and then sets it as a Cookie on the response, if the current request was made by a client to authenticate.</p>

<p>With this filter in place, when we authenticate, we will see the following behavior:</p>
<div class="highlight"><pre style="background-color:#f0f3f3;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">$ curl -I -X POST <span style="color:#c30">&#34;http://localhost:8080/login&#34;</span> -uuser:password
HTTP/1.1 <span style="color:#f60">200</span> OK
Server: Apache-Coyote/1.1
X-Content-Type-Options: nosniff
X-XSS-Protection: <span style="color:#f60">1</span>; <span style="color:#033">mode</span><span style="color:#555">=</span>block
Cache-Control: no-cache, no-store, max-age<span style="color:#555">=</span><span style="color:#f60">0</span>, must-revalidate
Pragma: no-cache
Expires: <span style="color:#f60">0</span>
X-Frame-Options: DENY
Set-Cookie: CSRF-TOKEN<span style="color:#555">=</span>628ae2c8-f35b-49a4-acc7-04fe87bdb98e; <span style="color:#033">Path</span><span style="color:#555">=</span>/
x-auth-token: 9444d058-eccb-471d-bc0d-460fd4c968e8
Content-Type: application/json;<span style="color:#033">charset</span><span style="color:#555">=</span>UTF-8
Transfer-Encoding: chunked
Date: Thu, <span style="color:#f60">21</span> Jul <span style="color:#f60">2016</span> <span style="color:#f60">02</span>:51:19 GMT</code></pre></div>
<p>We can clearly see that the CSRF token is sent to the client as a Cookie. At this point, we can make changes to our front end to send this token with every subsequent request. However, it is easier to use Angular&rsquo;s support for CSRF tokens.</p>

<h3 id="customizing-csrf-protection-for-angular">Customizing CSRF protection for Angular</h3>

<p>Angular&rsquo;s CSRF protection <sup class="footnote-ref" id="fnref:2"><a href="#fn:2">2</a></sup> uses the cookie <code>XSRF-TOKEN</code> it expects from server responses and the header <code>X-XSRF-TOKEN</code> which it will send for every subsequent request, once the Cookie is found in a response. We will have to configure Spring Security to use this header and token instead of it&rsquo;s default header <code>X-CSRF-TOKEN</code> and Cookie name <code>CSRF-TOKEN</code>.</p>

<p>The first step is to pass Spring Security a custom <code>CsrfTokenRepository</code>:</p>
<div class="highlight"><pre style="background-color:#f0f3f3;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-java" data-lang="java">    http
        <span style="color:#555">.</span><span style="color:#309">authorizeRequests</span><span style="color:#555">()</span>
        <span style="color:#555">.</span><span style="color:#309">antMatchers</span><span style="color:#555">(</span>patterns<span style="color:#555">)</span>
        <span style="color:#555">.</span><span style="color:#309">permitAll</span><span style="color:#555">()</span>
        <span style="color:#555">.</span><span style="color:#309">antMatchers</span><span style="color:#555">(</span><span style="color:#c30">&#34;/hello/**&#34;</span><span style="color:#555">)</span>
        <span style="color:#555">.</span><span style="color:#309">hasRole</span><span style="color:#555">(</span><span style="color:#c30">&#34;USER&#34;</span><span style="color:#555">)</span>
        <span style="color:#555">.</span><span style="color:#309">and</span><span style="color:#555">()</span>
        <span style="color:#555">.</span><span style="color:#309">csrf</span><span style="color:#555">()</span>
        <span style="color:#555">.</span><span style="color:#309">csrfTokenRepository</span><span style="color:#555">(</span>csrfTokenRepository<span style="color:#555">())</span>
        <span style="color:#555">.</span><span style="color:#309">requireCsrfProtectionMatcher</span><span style="color:#555">(</span>csrfProtectionMatcher<span style="color:#555">(</span>patterns<span style="color:#555">))</span>
        <span style="color:#555">.</span><span style="color:#309">and</span><span style="color:#555">()</span>
        <span style="color:#555">.</span><span style="color:#309">httpBasic</span><span style="color:#555">()</span>
        <span style="color:#555">.</span><span style="color:#309">and</span><span style="color:#555">()</span>
        <span style="color:#555">.</span><span style="color:#309">addFilterAfter</span><span style="color:#555">(</span><span style="color:#069;font-weight:bold">new</span> CsrfGrantingFilter<span style="color:#555">(),</span> SessionManagementFilter<span style="color:#555">.</span><span style="color:#309">class</span><span style="color:#555">);</span></code></pre></div>
<p>The <code>CsrfTokenRepository</code> is configured with the right header:</p>
<div class="highlight"><pre style="background-color:#f0f3f3;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-java" data-lang="java">  <span style="color:#069;font-weight:bold">private</span> CsrfTokenRepository <span style="color:#c0f">csrfTokenRepository</span><span style="color:#555">()</span> <span style="color:#555">{</span>
    HttpSessionCsrfTokenRepository repository <span style="color:#555">=</span> <span style="color:#069;font-weight:bold">new</span> HttpSessionCsrfTokenRepository<span style="color:#555">();</span>
    repository<span style="color:#555">.</span><span style="color:#309">setHeaderName</span><span style="color:#555">(</span><span style="color:#c30">&#34;X-XSRF-TOKEN&#34;</span><span style="color:#555">);</span>
    <span style="color:#069;font-weight:bold">return</span> repository<span style="color:#555">;</span>
  <span style="color:#555">}</span></code></pre></div>
<p>The next step is to set the Cookie with the right name in the <code>CsrfGrantingFilter</code>:</p>
<div class="highlight"><pre style="background-color:#f0f3f3;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-java" data-lang="java"><span style="color:#069;font-weight:bold">public</span> <span style="color:#069;font-weight:bold">class</span> <span style="color:#0a8;font-weight:bold">CsrfGrantingFilter</span> <span style="color:#069;font-weight:bold">implements</span> Filter <span style="color:#555">{</span>

  <span style="color:#99f">@Override</span>
  <span style="color:#069;font-weight:bold">public</span> <span style="color:#078;font-weight:bold">void</span> <span style="color:#c0f">init</span><span style="color:#555">(</span>FilterConfig filterConfig<span style="color:#555">)</span> <span style="color:#069;font-weight:bold">throws</span> ServletException <span style="color:#555">{}</span>

  <span style="color:#99f">@Override</span>
  <span style="color:#069;font-weight:bold">public</span> <span style="color:#078;font-weight:bold">void</span> <span style="color:#c0f">doFilter</span><span style="color:#555">(</span>ServletRequest servletRequest<span style="color:#555">,</span> ServletResponse servletResponse<span style="color:#555">,</span> FilterChain filterChain<span style="color:#555">)</span>
      <span style="color:#069;font-weight:bold">throws</span> IOException<span style="color:#555">,</span> ServletException <span style="color:#555">{</span>
    CsrfToken csrf <span style="color:#555">=</span> <span style="color:#555">(</span>CsrfToken<span style="color:#555">)</span> servletRequest<span style="color:#555">.</span><span style="color:#309">getAttribute</span><span style="color:#555">(</span>CsrfToken<span style="color:#555">.</span><span style="color:#309">class</span><span style="color:#555">.</span><span style="color:#309">getName</span><span style="color:#555">());</span>
    String token <span style="color:#555">=</span> csrf<span style="color:#555">.</span><span style="color:#309">getToken</span><span style="color:#555">();</span>
    <span style="color:#069;font-weight:bold">if</span> <span style="color:#555">(</span>token <span style="color:#555">!=</span> <span style="color:#069;font-weight:bold">null</span> <span style="color:#555">&amp;&amp;</span> isAuthenticating<span style="color:#555">(</span>servletRequest<span style="color:#555">))</span> <span style="color:#555">{</span>
      HttpServletResponse response <span style="color:#555">=</span> <span style="color:#555">(</span>HttpServletResponse<span style="color:#555">)</span> servletResponse<span style="color:#555">;</span>
      Cookie cookie <span style="color:#555">=</span> <span style="color:#069;font-weight:bold">new</span> Cookie<span style="color:#555">(</span><span style="color:#c30">&#34;XSRF-TOKEN&#34;</span><span style="color:#555">,</span> token<span style="color:#555">);</span>
      cookie<span style="color:#555">.</span><span style="color:#309">setPath</span><span style="color:#555">(</span><span style="color:#c30">&#34;/&#34;</span><span style="color:#555">);</span>
      response<span style="color:#555">.</span><span style="color:#309">addCookie</span><span style="color:#555">(</span>cookie<span style="color:#555">);</span>
    <span style="color:#555">}</span>
    filterChain<span style="color:#555">.</span><span style="color:#309">doFilter</span><span style="color:#555">(</span>servletRequest<span style="color:#555">,</span> servletResponse<span style="color:#555">);</span>
  <span style="color:#555">}</span>

  <span style="color:#069;font-weight:bold">private</span> <span style="color:#078;font-weight:bold">boolean</span> <span style="color:#c0f">isAuthenticating</span><span style="color:#555">(</span>ServletRequest servletRequest<span style="color:#555">)</span> <span style="color:#555">{</span>
    HttpServletRequest request <span style="color:#555">=</span> <span style="color:#555">(</span>HttpServletRequest<span style="color:#555">)</span> servletRequest<span style="color:#555">;</span>
    <span style="color:#069;font-weight:bold">return</span> request<span style="color:#555">.</span><span style="color:#309">getRequestURI</span><span style="color:#555">().</span><span style="color:#309">equals</span><span style="color:#555">(</span><span style="color:#c30">&#34;/login&#34;</span><span style="color:#555">);</span>
  <span style="color:#555">}</span>

  <span style="color:#99f">@Override</span>
  <span style="color:#069;font-weight:bold">public</span> <span style="color:#078;font-weight:bold">void</span> <span style="color:#c0f">destroy</span><span style="color:#555">()</span> <span style="color:#555">{}</span>
<span style="color:#555">}</span></code></pre></div>
<p>With these configurations in place, the front end is able to authenticate and obtain a token Cookie which Angular will pass for every subsequent request.</p>

<h3 id="configuring-order-of-enforcement">Configuring order of enforcement</h3>

<p>The only drawback to the configurations we have developed so far is that when a client makes a request to a protected end point with out Authentication and CSRF token, it will receive a <code>403 Forbidden</code> instead of a <code>401 Unauthorized</code>.</p>
<div class="highlight"><pre style="background-color:#f0f3f3;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">$ curl -I -X GET <span style="color:#c30">&#34;http://localhost:8080/hello&#34;</span>
HTTP/1.1 <span style="color:#f60">403</span> Forbidden
Server: Apache-Coyote/1.1
X-Content-Type-Options: nosniff
X-XSS-Protection: <span style="color:#f60">1</span>; <span style="color:#033">mode</span><span style="color:#555">=</span>block
Cache-Control: no-cache, no-store, max-age<span style="color:#555">=</span><span style="color:#f60">0</span>, must-revalidate
Pragma: no-cache
Expires: <span style="color:#f60">0</span>
X-Frame-Options: DENY
x-auth-token: a0abe09c-94cb-4966-9ee6-a5327f3bd939
Content-Type: application/json;<span style="color:#033">charset</span><span style="color:#555">=</span>UTF-8
Transfer-Encoding: chunked
Date: Thu, <span style="color:#f60">21</span> Jul <span style="color:#f60">2016</span> <span style="color:#f60">03</span>:16:01 GMT</code></pre></div>
<p>This happens because by default, when CSRF protection is enabled, <code>CsrfFilter</code> appears in the filter chain before <code>FilterSecurityInterceptor</code>. For this example, this is the order:</p>

<pre><code>0 = {WebAsyncManagerIntegrationFilter@7344}
1 = {SecurityContextPersistenceFilter@7343}
2 = {HeaderWriterFilter@7342}
3 = {CsrfFilter@7339}
4 = {LogoutFilter@7382}
5 = {BasicAuthenticationFilter@7381}
6 = {RequestCacheAwareFilter@8965}
7 = {SecurityContextHolderAwareRequestFilter@8964}
8 = {AnonymousAuthenticationFilter@8963}
9 = {SessionManagementFilter@8962}
10 = {CsrfGrantingFilter@8978}
11 = {ExceptionTranslationFilter@9333}
12 = {FilterSecurityInterceptor@9334}
</code></pre>

<p>If this is not the behavior desirable for your application, we can disable the default CSRF protection and enable the required filters, enforcing the right order. This is achieved with the following configuration:</p>
<div class="highlight"><pre style="background-color:#f0f3f3;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-java" data-lang="java">    http
        <span style="color:#555">.</span><span style="color:#309">authorizeRequests</span><span style="color:#555">()</span>
        <span style="color:#555">.</span><span style="color:#309">antMatchers</span><span style="color:#555">(</span>patterns<span style="color:#555">)</span>
        <span style="color:#555">.</span><span style="color:#309">permitAll</span><span style="color:#555">()</span>
        <span style="color:#555">.</span><span style="color:#309">antMatchers</span><span style="color:#555">(</span><span style="color:#c30">&#34;/hello/**&#34;</span><span style="color:#555">)</span>
        <span style="color:#555">.</span><span style="color:#309">hasRole</span><span style="color:#555">(</span><span style="color:#c30">&#34;USER&#34;</span><span style="color:#555">)</span>
        <span style="color:#555">.</span><span style="color:#309">and</span><span style="color:#555">()</span>
        <span style="color:#555">.</span><span style="color:#309">csrf</span><span style="color:#555">()</span>
        <span style="color:#555">.</span><span style="color:#309">disable</span><span style="color:#555">()</span>
        <span style="color:#555">.</span><span style="color:#309">httpBasic</span><span style="color:#555">()</span>
        <span style="color:#555">.</span><span style="color:#309">and</span><span style="color:#555">()</span>
        <span style="color:#555">.</span><span style="color:#309">addFilterAfter</span><span style="color:#555">(</span>csrfFilter<span style="color:#555">(</span>patterns<span style="color:#555">),</span> FilterSecurityInterceptor<span style="color:#555">.</span><span style="color:#309">class</span><span style="color:#555">)</span>
        <span style="color:#555">.</span><span style="color:#309">addFilterAfter</span><span style="color:#555">(</span><span style="color:#069;font-weight:bold">new</span> CsrfGrantingFilter<span style="color:#555">(),</span> CsrfFilter<span style="color:#555">.</span><span style="color:#309">class</span><span style="color:#555">);</span></code></pre></div>
<p>The CSRF filter is built with the right repository and URL matchers:</p>
<div class="highlight"><pre style="background-color:#f0f3f3;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-java" data-lang="java">  <span style="color:#069;font-weight:bold">private</span> Filter <span style="color:#c0f">csrfFilter</span><span style="color:#555">(</span>String<span style="color:#555">[]</span> patterns<span style="color:#555">)</span> <span style="color:#555">{</span>
    CsrfFilter csrfFilter <span style="color:#555">=</span> <span style="color:#069;font-weight:bold">new</span> CsrfFilter<span style="color:#555">(</span>csrfTokenRepository<span style="color:#555">());</span>
    csrfFilter<span style="color:#555">.</span><span style="color:#309">setRequireCsrfProtectionMatcher</span><span style="color:#555">(</span>csrfProtectionMatcher<span style="color:#555">(</span>patterns<span style="color:#555">));</span>
    <span style="color:#069;font-weight:bold">return</span> csrfFilter<span style="color:#555">;</span>
  <span style="color:#555">}</span>

  <span style="color:#069;font-weight:bold">private</span> NoAntPathRequestMatcher <span style="color:#c0f">csrfProtectionMatcher</span><span style="color:#555">(</span>String<span style="color:#555">[]</span> patterns<span style="color:#555">)</span> <span style="color:#555">{</span>
    <span style="color:#069;font-weight:bold">return</span> <span style="color:#069;font-weight:bold">new</span> NoAntPathRequestMatcher<span style="color:#555">(</span>patterns<span style="color:#555">);</span>
  <span style="color:#555">}</span>

  <span style="color:#069;font-weight:bold">private</span> CsrfTokenRepository <span style="color:#c0f">csrfTokenRepository</span><span style="color:#555">()</span> <span style="color:#555">{</span>
    HttpSessionCsrfTokenRepository repository <span style="color:#555">=</span> <span style="color:#069;font-weight:bold">new</span> HttpSessionCsrfTokenRepository<span style="color:#555">();</span>
    repository<span style="color:#555">.</span><span style="color:#309">setHeaderName</span><span style="color:#555">(</span><span style="color:#c30">&#34;X_XSRF_TOKEN&#34;</span><span style="color:#555">);</span>
    <span style="color:#069;font-weight:bold">return</span> repository<span style="color:#555">;</span>
  <span style="color:#555">}</span></code></pre></div>
<p>This will result in the right order of errors:</p>
<div class="highlight"><pre style="background-color:#f0f3f3;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">$ curl -I -X GET <span style="color:#c30">&#34;http://localhost:8080/hello&#34;</span>
HTTP/1.1 <span style="color:#f60">401</span> Unauthorized
Server: Apache-Coyote/1.1
X-Content-Type-Options: nosniff
X-XSS-Protection: <span style="color:#f60">1</span>; <span style="color:#033">mode</span><span style="color:#555">=</span>block
Cache-Control: no-cache, no-store, max-age<span style="color:#555">=</span><span style="color:#f60">0</span>, must-revalidate
Pragma: no-cache
Expires: <span style="color:#f60">0</span>
X-Frame-Options: DENY
WWW-Authenticate: Basic <span style="color:#033">realm</span><span style="color:#555">=</span><span style="color:#c30">&#34;Realm&#34;</span>
x-auth-token: 08a06acd-3398-4fc4-af25-23d3f4155a2b
Content-Type: application/json;<span style="color:#033">charset</span><span style="color:#555">=</span>UTF-8
Transfer-Encoding: chunked
Date: Thu, <span style="color:#f60">21</span> Jul <span style="color:#f60">2016</span> <span style="color:#f60">03</span>:27:58 GMT</code></pre></div>
<p>This is the end of this blog post. In this example, we built an application with CSRF protection that works well with Angular JS. The code for this blog post is available <a href="https://github.com/sdqali/csrf-demo">on GitHub</a>.</p>
<div class="footnotes">

<hr />

<ol>
<li id="fn:1">For a detailed explanation, see Cross-Site Request Forgery (CSRF) <a href="https://www.owasp.org/index.php/Cross-Site_Request_Forgery_(CSRF)">on OWASP</a>.
 <a class="footnote-return" href="#fnref:1"><sup>[return]</sup></a></li>
<li id="fn:2">See section <em>Cross Site Request Forgery (XSRF) Protection</em> in <a href="https://docs.angularjs.org/api/ng/service/$http">the official documentation</a>.
 <a class="footnote-return" href="#fnref:2"><sup>[return]</sup></a></li>
</ol>
</div>
        </div>
        <aside>
          <p class="comments">
  If you have questions or comments about this blog post, you can get in touch with me on Twitter <a href="https://twitter.com/sdqali">@sdqali</a>.
</p>

        </aside>
        <aside>
          <h3>If you liked this post, you'll also like...</h3>
          <ul class="related-posts">
            
            
            
            
            
            
            <li><a href="https://sdqali.in/blog/2019/03/23/understanding-trailing-processing-in-sas-input/?utm_source=site&amp;utm_medium=related">Understanding trailing @ processing in SAS input</a></li>
            
            
            
            
            
            <li><a href="https://sdqali.in/blog/2019/03/23/importing-the-sasuser-datasets-in-sas-studio/?utm_source=site&amp;utm_medium=related">Importing the SASUSER datasets in SAS Studio</a></li>
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            <li><a href="https://sdqali.in/blog/2016/11/29/implementing-feature-toggles-for-a-spring-boot-application-part-4/?utm_source=site&amp;utm_medium=related">Implementing feature toggles for a Spring Boot application - Part 4</a></li>
            
            
            
            
            
            <li><a href="https://sdqali.in/blog/2016/11/28/implementing-feature-toggles-for-a-spring-boot-application-part-3/?utm_source=site&amp;utm_medium=related">Implementing feature toggles for a Spring Boot application - Part 3</a></li>
            
            
            
            
            
            <li><a href="https://sdqali.in/blog/2016/11/26/implementing-feature-toggles-for-a-spring-boot-application-part-2/?utm_source=site&amp;utm_medium=related">Implementing feature toggles for a Spring Boot application - Part 2</a></li>
            
            
            
            
            
            <li><a href="https://sdqali.in/blog/2016/11/21/implementing-feature-toggles-for-a-spring-boot-application-part-1/?utm_source=site&amp;utm_medium=related">Implementing feature toggles for a Spring Boot application - Part 1</a></li>
            
            
            
            
            
            <li><a href="https://sdqali.in/blog/2016/11/11/setting-up-a-secure-etcd-cluster-behind-a-proxy/?utm_source=site&amp;utm_medium=related">Setting up a secure etcd cluster behind a proxy</a></li>
            
            
            
            
            
            
            
            
            
            <li><a href="https://sdqali.in/blog/2016/11/02/handling-deserialization-errors-in-spring-redis-sessions/?utm_source=site&amp;utm_medium=related">Handling Deserialization errors in Spring Redis Sessions</a></li>
            
            
            
            
            
            
            
            
            
            <li><a href="https://sdqali.in/blog/2016/07/16/controlling-redis-auto-configuration-for-spring-boot-session/?utm_source=site&amp;utm_medium=related">Controlling Redis auto-configuration for Spring Boot Session</a></li>
            
            
            
            
            
            <li><a href="https://sdqali.in/blog/2016/07/13/jwt-authentication-with-spring-web-part-5/?utm_source=site&amp;utm_medium=related">JWT authentication with Spring Web - Part 5</a></li>
            
            
            
            
            
            <li><a href="https://sdqali.in/blog/2016/07/07/jwt-authentication-with-spring-web-part-4/?utm_source=site&amp;utm_medium=related">JWT authentication with Spring Web - Part 4</a></li>
            
            
            
            
            
            <li><a href="https://sdqali.in/blog/2016/07/05/jwt-authentication-with-spring-web-part-3/?utm_source=site&amp;utm_medium=related">JWT authentication with Spring Web - Part 3</a></li>
            
            
            
            
            
            <li><a href="https://sdqali.in/blog/2016/07/03/jwt-authentication-with-spring-web-part-2/?utm_source=site&amp;utm_medium=related">JWT authentication with Spring Web - Part 2</a></li>
            
            
            
            
            
            <li><a href="https://sdqali.in/blog/2016/07/02/jwt-authentication-with-spring-web-part-1/?utm_source=site&amp;utm_medium=related">JWT authentication with Spring Web - Part 1</a></li>
            
            
            
            
            
            <li><a href="https://sdqali.in/blog/2016/06/30/json-logging-for-spring-applications/?utm_source=site&amp;utm_medium=related">JSON logging for Spring applications</a></li>
            
            
            
            
            
            <li><a href="https://sdqali.in/blog/2016/06/28/injecting-dependencies-into-a-spring-configuration/?utm_source=site&amp;utm_medium=related">Injecting dependencies into a Spring @Configuration</a></li>
            
            
            
            
            
            <li><a href="https://sdqali.in/blog/2016/06/08/filtering-responses-in-spring-mvc/?utm_source=site&amp;utm_medium=related">Filtering responses in Spring MVC</a></li>
            
            
            
            
            
            
            
            
            
            <li><a href="https://sdqali.in/blog/2016/04/24/deprecating-domain-events-in-axon/?utm_source=site&amp;utm_medium=related">Deprecating domain events in Axon</a></li>
            
            
            
            
            
            <li><a href="https://sdqali.in/blog/2016/04/19/programmable-exit-codes-for-spring-command-line-applications-2/?utm_source=site&amp;utm_medium=related">Programmable exit codes for spring command line applications - 2</a></li>
            
            
            
            
            
            <li><a href="https://sdqali.in/blog/2016/04/17/programmable-exit-codes-for-spring-command-line-applications/?utm_source=site&amp;utm_medium=related">Programmable exit codes for Spring command line applications</a></li>
            
            
            
            
            
            <li><a href="https://sdqali.in/blog/2016/01/29/using-custom-arguments-in-spring-mvc-controllers/?utm_source=site&amp;utm_medium=related">Using custom arguments in Spring MVC controllers</a></li>
            
            
            
            
            
            <li><a href="https://sdqali.in/blog/2015/12/16/authentication-for-apache-camel-http-components/?utm_source=site&amp;utm_medium=related">Authentication for Apache Camel HTTP components</a></li>
            
            
            
            
            
            <li><a href="https://sdqali.in/blog/2015/12/14/thoughts-on-open-graph-tags/?utm_source=site&amp;utm_medium=related">Thoughts on Open Graph tags</a></li>
            
            
            
            
            
            <li><a href="https://sdqali.in/blog/2015/12/11/integration-testing-spring-command-line-applications/?utm_source=site&amp;utm_medium=related">Integration testing Spring command line applications</a></li>
            
            
            
            
            
            <li><a href="https://sdqali.in/blog/2015/12/10/integration-testing-challenges-for-non-web-spring-applications/?utm_source=site&amp;utm_medium=related">Integration testing challenges for non-web Spring applications</a></li>
            
            
            
            
            
            <li><a href="https://sdqali.in/blog/2015/12/07/how-thinking-of-documentation-as-legislation-helped-me-become-a-better-programmer/?utm_source=site&amp;utm_medium=related">How thinking of Documentation as Legislation helped me become a better programmer</a></li>
            
            
            
            
            
            <li><a href="https://sdqali.in/blog/2015/12/06/implementing-custom-annotations-for-spring-mvc/?utm_source=site&amp;utm_medium=related">Implementing custom annotations for Spring MVC</a></li>
            
            
            
            
            
            <li><a href="https://sdqali.in/blog/2015/12/04/validating-requestparams-and-pathvariables-in-spring-mvc/?utm_source=site&amp;utm_medium=related">Validating RequestParams and PathVariables in Spring MVC</a></li>
            
            
            
            
            
            <li><a href="https://sdqali.in/blog/2015/11/24/testing-async-responses-using-mockmvc/?utm_source=site&amp;utm_medium=related">Testing async responses using MockMvc</a></li>
            
            
            
            
            
            <li><a href="https://sdqali.in/blog/2015/06/09/running-multiple-applications-in-the-same-tomcat-installation/?utm_source=site&amp;utm_medium=related">Running multiple applications in the same Tomcat installation</a></li>
            
            
            
            
            
            <li><a href="https://sdqali.in/blog/2015/05/21/making-sense-of-cloud-foundry-security-group-declarations/?utm_source=site&amp;utm_medium=related">Making sense of Cloud Foundry security group declarations</a></li>
            
            
            
            
            
            <li><a href="https://sdqali.in/blog/2015/05/20/configuring-cloud-foundry-java-memory-parameters/?utm_source=site&amp;utm_medium=related">Configuring Cloud Foundry Java Memory Parameters</a></li>
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            <li><a href="https://sdqali.in/blog/2014/03/20/clojure-dojo-levenshtein-edit-distance/?utm_source=site&amp;utm_medium=related">Clojure Dojo - Levenshtein edit distance</a></li>
            
            
            
            
            
            <li><a href="https://sdqali.in/blog/2014/02/17/a-simple-jmeter-test-with-login/?utm_source=site&amp;utm_medium=related">A simple JMeter test with login</a></li>
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            <li><a href="https://sdqali.in/blog/2013/10/13/implementing-rate-limiting-in-rails-part-2/?utm_source=site&amp;utm_medium=related">Implementing Rate Limiting in Rails - Part 2</a></li>
            
            
            
            
            
            <li><a href="https://sdqali.in/blog/2013/10/12/implementing-rate-limiting-in-rails-part-1/?utm_source=site&amp;utm_medium=related">Implementing Rate Limiting in Rails - Part 1</a></li>
            
            
            
            
            
            <li><a href="https://sdqali.in/blog/2013/10/07/python-hack-dynamically-override-an-objects-attribute/?utm_source=site&amp;utm_medium=related">Python Hack - Dynamically override an object&#39;s attribute</a></li>
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            <li><a href="https://sdqali.in/blog/2013/09/12/managing-gemsets-in-rbenv/?utm_source=site&amp;utm_medium=related">Managing Gemsets in Rbenv</a></li>
            
            
            
            
            
            <li><a href="https://sdqali.in/blog/2013/09/08/looking-up-compiler-params-used-to-compile-a-ruby-version/?utm_source=site&amp;utm_medium=related">Looking up Compiler params used to compile a Ruby version</a></li>
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            <li><a href="https://sdqali.in/blog/2013/08/15/pythons-bool-type/?utm_source=site&amp;utm_medium=related">Python&#39;s bool type</a></li>
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            <li><a href="https://sdqali.in/blog/2013/07/31/validating-json-in-emacs/?utm_source=site&amp;utm_medium=related">Validating JSON in Emacs</a></li>
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            <li><a href="https://sdqali.in/blog/2013/04/29/emacs-hack-viewing-git-logs-while-composing-commit-messages/?utm_source=site&amp;utm_medium=related">Emacs hack: Viewing Git logs while composing commit messages</a></li>
            
            
            
            
            
            <li><a href="https://sdqali.in/blog/2013/04/14/configure-gits-comment-character/?utm_source=site&amp;utm_medium=related">Configure Git&#39;s comment character</a></li>
            
            
            
            
            
            <li><a href="https://sdqali.in/blog/2013/04/11/my-experience-working-remotely/?utm_source=site&amp;utm_medium=related">My experience working remotely</a></li>
            
            
            
            
            
            <li><a href="https://sdqali.in/blog/2013/04/08/oh-i-can-build-it-in.../?utm_source=site&amp;utm_medium=related">Oh I can build it in...</a></li>
            
            
            
            
            
            <li><a href="https://sdqali.in/blog/2013/04/05/javascript-clipboard-access-and-hidden-flash-widgets/?utm_source=site&amp;utm_medium=related">JavaScript, clipboard access and hidden flash widgets</a></li>
            
            
            
            
            
            <li><a href="https://sdqali.in/blog/2013/01/22/reducing-emacs-startup-time-while-committing/?utm_source=site&amp;utm_medium=related">Reducing Emacs startup time while committing</a></li>
            
            
            
            
            
            
            
            
            
            
            
            
            
            <li><a href="https://sdqali.in/blog/2012/11/29/my-first-firefox-plugin-getcache-view-cached-version-of-the-current-page/?utm_source=site&amp;utm_medium=related">My first Firefox plugin: GetCache - View cached version of the current page</a></li>
            
            
            
            
            
            <li><a href="https://sdqali.in/blog/2012/11/28/getcache-a-chrome-plugin-to-view-cached-version-of-the-current-page/?utm_source=site&amp;utm_medium=related">GetCache - A Chrome plugin to view cached version of the current page</a></li>
            
            
            
            
            
            <li><a href="https://sdqali.in/blog/2012/11/27/on-rest-content-type-google-chrome-and-caching/?utm_source=site&amp;utm_medium=related">On REST, Content-Type, Google Chrome and Caching</a></li>
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            <li><a href="https://sdqali.in/blog/2012/07/09/understanding-pythons-with-statement/?utm_source=site&amp;utm_medium=related">Understanding Python&#39;s &#34;with&#34; statement</a></li>
            
            
            
            
            
            <li><a href="https://sdqali.in/blog/2012/07/04/heredocs-in-ruby-and-python/?utm_source=site&amp;utm_medium=related">Heredocs in Ruby and Python</a></li>
            
            
            
            
            
            <li><a href="https://sdqali.in/blog/2012/06/25/micro-journal-simple-git-backed-journal-in-python/?utm_source=site&amp;utm_medium=related">Micro Journal - simple Git-backed journal in Python</a></li>
            
            
            
            
            
            <li><a href="https://sdqali.in/blog/2012/06/24/vodqa-ncr-maintaining-large-test-suites/?utm_source=site&amp;utm_medium=related">VodQA NCR: Maintaining Large Test Suites</a></li>
            
            
            
            
            
            <li><a href="https://sdqali.in/blog/2012/06/06/know-your-tools-dont-shoot-yourself-in-the-foot/?utm_source=site&amp;utm_medium=related">Know Your Tools - Don&#39;t Shoot Yourself in the Foot</a></li>
            
            
            
            
            
            <li><a href="https://sdqali.in/blog/2012/06/05/managing-security-certificates-from-the-console-on-windows-mac-os-x-and-linux/?utm_source=site&amp;utm_medium=related">Managing security certificates from the console - on Windows, Mac OS X and Linux</a></li>
            
            
            
            
            
            
            
            
            
            
            
            
            
            <li><a href="https://sdqali.in/blog/2012/05/11/indian-and-pakistani-cricketers-who-make-better-debuts/?utm_source=site&amp;utm_medium=related">Indian and Pakistani cricketers - who make better debuts?</a></li>
            
            
            
            
            
            <li><a href="https://sdqali.in/blog/2012/05/04/fixing-flyspell-for-emacs-in-mac-os-x/?utm_source=site&amp;utm_medium=related">Fixing Flyspell for Emacs in Mac OS X</a></li>
            
            
            
            
            
            <li><a href="https://sdqali.in/blog/2012/04/29/finding-un-merged-commits-with-git-cherry/?utm_source=site&amp;utm_medium=related">Finding un-merged commits with git cherry</a></li>
            
            
            
            
            
            <li><a href="https://sdqali.in/blog/2012/02/03/bullet-proof-jenkins-setup/?utm_source=site&amp;utm_medium=related">Bullet proof Jenkins setup</a></li>
            
            
            
            
            
            <li><a href="https://sdqali.in/blog/2012/01/17/why-your-project-should-have-a-getting-started-guide./?utm_source=site&amp;utm_medium=related">Why your project should have a Getting Started guide.</a></li>
            
            
            
            
            
            <li><a href="https://sdqali.in/blog/2012/01/16/debugging-c-sharps-httpwebrequest-100-continue-and-nginx/?utm_source=site&amp;utm_medium=related">Debugging: C Sharp&#39;s HttpWebRequest, 100-Continue and nginx</a></li>
            
            
            
            
            
            
            
            
            
            <li><a href="https://sdqali.in/blog/2011/05/17/wikipedia-page-hopping/?utm_source=site&amp;utm_medium=related">Wikipedia Page Hopping</a></li>
            
            
            
            
            
            
            
            
            
            
            
            
            
            <li><a href="https://sdqali.in/blog/2011/03/24/empathy-log-parser/?utm_source=site&amp;utm_medium=related">Empathy Log Parser</a></li>
            
            
            
            
            
            <li><a href="https://sdqali.in/blog/2011/03/23/binary-signature-art/?utm_source=site&amp;utm_medium=related">Binary Signature Art</a></li>
            
            
            
            
            
            
            
            
            
            <li><a href="https://sdqali.in/blog/2010/03/16/java-arrays-in-jruby/?utm_source=site&amp;utm_medium=related">Java Arrays in JRuby</a></li>
            
            
            
            
            
            
            
            
            
            
            
            
            
            <li><a href="https://sdqali.in/blog/2010/01/09/autorun.py-execute-stuff-on-file-change/?utm_source=site&amp;utm_medium=related">Autorun.py - Execute stuff on file change</a></li>
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
          </ul>
        </aside>
      </div>
    </article>

    <hr>

    
<footer  itemscope="itemscope" itemtype="http://schema.org/WPFooter">
  <div >
    <div >
      <div >
        <ul >
          <li>
            <a href="https://twitter.com/sdqali">
              <span >Twitter</span>
              <span  aria-hidden="true">
                <span ></span>
                <span ></span>
              </span>
            </a>
          </li>
          <li>
            <a href="https://plus.google.com/115900084932734914678">
              <span >Google+</span>
              <span  aria-hidden="true">
                <span ></span>
                <span ></span>
              </span>
            </a>
          </li>
          <li>
            <a href="https://linkedin.com/in/sdqali">
              <span >LinkedIn</span>
              <span  aria-hidden="true">
                <span ></span>
                <span ></span>
              </span>
            </a>
          </li>
          <li>
            <a href="https://github.com/sdqali">
              <span >GitHub</span>
              <span  aria-hidden="true">
                <span ></span>
                <span ></span>
              </span>
            </a>
          </li>
          <li>
            <a href="/index.xml">
              <span >Atom Feed</span>
              <span  aria-hidden="true">
                <span ></span>
                <span ></span>
              </span>
            </a>
          </li>
        </ul>
        <p >&copy; All rights reserved.</p>
      </div>
    </div>
  </div>
</footer>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-86967633-1', 'auto');
  ga('send', 'pageview');

</script>

<link rel="stylesheet" href="/style.css"/>

  </body>
</html>
