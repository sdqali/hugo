<!DOCTYPE html5>
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en-us" prefix="og: http://ogp.me/ns#">
  <head>

    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="">
    <meta name="author" content="">

    <title>Graph databases 1 - Modeling</title>

    
    <link href="/css/bootstrap.min.css" rel="stylesheet">

    
    <link href="/css/clean-blog.min.css" rel="stylesheet">
    <link href="/css/custom.css" rel="stylesheet">

    
    <link href="/font-awesome/4.1.0/css/font-awesome.min.css" rel="stylesheet" type="text/css">
    <link href='/css/fonts.css' rel='stylesheet' type='text/css'>

    
    
    

</head>

  
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:site" content="@sdqali">
  <meta name="twitter:creator" content="@sdqali">
  <meta name="twitter:title" content="Graph databases 1 - Modeling">
  <meta name="twitter:description" content="I am making my way through the book Graph Databases 1 which is an introductory book to the subject from Neo Technology 2, creators of Neo4j 3. At work, we are using Neo4j for a cool new thing we are building, and I see it as a great chance to learn some thing new and interesting. In the past, I have gone through a spiral 4 when it comes to learning stuff and the constant feedback I get is to pick something that one gets to work with everyday and dig deep into it, in order to avoid the frustration and the inevitable spiral.

">
  <meta name="twitter:image" content="http://sdqali.in/map[feature:/images/threaded-blue-on-black-cropped.jpg]">

  <meta property="og:title" content="Graph databases 1 - Modeling" />
  <meta property="og:description" content="I am making my way through the book Graph Databases 1 which is an introductory book to the subject from Neo Technology 2, creators of Neo4j 3. At work, we are using Neo4j for a cool new thing we are building, and I see it as a great chance to learn some thing new and interesting. In the past, I have gone through a spiral 4 when it comes to learning stuff and the constant feedback I get is to pick something that one gets to work with everyday and dig deep into it, in order to avoid the frustration and the inevitable spiral.

" itemprop="description"/>
  <meta property="og:url" content="http://sdqali.in/blog/2013/08/02/graph-databases-1---modeling/" />
  <meta property="og:image" content="http://sdqali.in/map[feature:/images/threaded-blue-on-black-cropped.jpg]" />
  <body>

    <nav class="navbar navbar-default navbar-custom navbar-fixed-top">
  <div class="container-fluid">
    
    <div class="navbar-header page-scroll">
      <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="/">Sadique Ali</a>
    </div>

    
    <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
      <ul class="nav navbar-nav navbar-right">
        <li><a href="/">Home</a> </li>
        <li><a href="/blog/">Blog</a> </li>
        <li><a href="/about">About</a> </li>
        <li><a href="/index.xml">Atom Feed</a> </li>
        <li><a href="https://github.com/sdqali">GitHub</a> </li>
        <li><a href="https://twitter.com/sdqali">Twitter</a> </li>
        <li><a href="https://www.linkedin.com/in/sdqali">LinkedIn</a> </li>
      </ul>
    </div>
    
  </div>
  
</nav>




    
    
    <header class="intro-header">
      <div class="container">
        <div class="row">
          <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
            <div class="site-heading">
              <h1> Graph databases 1 - Modeling</h1>
              <span class="meta">Fri, Aug 2, 2013</span>
            </div>
          </div>
        </div>
      </div>
    </header>


    
    <article>
      <div class="container">
        <div class="row">
          <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
            <p>I am making my way through the book <em>Graph Databases</em> <sup class="footnote-ref" id="fnref:1"><a rel="footnote" href="#fn:1">1</a></sup> which is an introductory book to the subject from Neo Technology <sup class="footnote-ref" id="fnref:2"><a rel="footnote" href="#fn:2">2</a></sup>, creators of Neo4j <sup class="footnote-ref" id="fnref:3"><a rel="footnote" href="#fn:3">3</a></sup>. At work, we are using Neo4j for a cool new thing we are building, and I see it as a great chance to learn some thing new and interesting. In the past, I have gone through a spiral <sup class="footnote-ref" id="fnref:4"><a rel="footnote" href="#fn:4">4</a></sup> when it comes to learning stuff and the constant feedback I get is to pick something that one gets to work with everyday and dig deep into it, in order to avoid the frustration and the inevitable spiral.</p>

<p></p>

<p>This is obviously a completely new subject to me and I am enjoying it so far. I am going to write a series of blog posts about my effort to learn Graph Databases and my observations and learnings.</p>

<p>I am presently reading chapter 3, which deals with <em>Data Modeling with Graphs</em>. The key idea here is that the graph representation mirrors entities and relationships.</p>

<ul>
<li>Entities are represented by <em>nodes</em> and their characteristics are represented as <em>properties</em> of the node. Eg. : Cristiano Ronaldo is a <em>node</em>, while his height is a <em>property</em>.</li>
<li>Relationships are modeled by <em>relationships</em>. Eg. : _OF_NATIONAL<em>TEAM</em> is a <em>relationship</em>.</li>
<li>Relationships always connect two <em>nodes</em></li>
<li>Relationships sometimes have properties. Eg. : <em>debut</em> is a property of the _OF_NATIONAL<em>TEAM</em> relationship.</li>
</ul>

<h1 id="example-european-football-players">Example - European football players</h1>

<p>If we were to model football players to have played for European clubs, a section of the graph will look like this:</p>

<p><img src="/images/graph_zidane.png" alt="Graph: Zidane and teams" /></p>

<h1 id="building-the-graph-with-cypher">Building the graph with Cypher</h1>

<p>Cypher <sup class="footnote-ref" id="fnref:5"><a rel="footnote" href="#fn:5">5</a></sup> is Neo4j&rsquo;s query language. It is essentially structured ASCII art that tries to be as close to how relationships are mapped on a graph. The above graph can be created in Neo4j using the following Cypher snippet:</p>
<div class="highlight" style="background: #f0f3f3"><pre style="line-height: 125%"><span></span><span style="color: #006699; font-weight: bold">CREATE</span> (zidane <span style="color: #AA0000; background-color: #FFAAAA">{</span>name: <span style="color: #FFCC33">&quot;Zinadine Zidane&quot;</span>, <span style="color: #006699; font-weight: bold">position</span>: <span style="color: #FFCC33">&quot;Midfielder&quot;</span> <span style="color: #AA0000; background-color: #FFAAAA">}</span>),
(cannes <span style="color: #AA0000; background-color: #FFAAAA">{</span>name: <span style="color: #FFCC33">&quot;A.S. Cannes&quot;</span>, founded: <span style="color: #FF6600">1902</span><span style="color: #AA0000; background-color: #FFAAAA">}</span>),
(bordeaux <span style="color: #AA0000; background-color: #FFAAAA">{</span>name: <span style="color: #FFCC33">&quot;F.C.G. de Bordeaux&quot;</span>, founded: <span style="color: #FF6600">1881</span><span style="color: #AA0000; background-color: #FFAAAA">}</span>),
(juventus <span style="color: #AA0000; background-color: #FFAAAA">{</span>name: <span style="color: #FFCC33">&quot;Juventus F.C.&quot;</span>, founded: <span style="color: #FF6600">1897</span><span style="color: #AA0000; background-color: #FFAAAA">}</span>),
(realmadrid <span style="color: #AA0000; background-color: #FFAAAA">{</span>name: <span style="color: #FFCC33">&quot;Real Madrid C.F.&quot;</span>, founded: <span style="color: #FF6600">1902</span><span style="color: #AA0000; background-color: #FFAAAA">}</span>),
(spain <span style="color: #AA0000; background-color: #FFAAAA">{</span>name: <span style="color: #FFCC33">&quot;Spain&quot;</span><span style="color: #AA0000; background-color: #FFAAAA">}</span>),
(france <span style="color: #AA0000; background-color: #FFAAAA">{</span>name: <span style="color: #FFCC33">&quot;France&quot;</span><span style="color: #AA0000; background-color: #FFAAAA">}</span>),
(italy <span style="color: #AA0000; background-color: #FFAAAA">{</span>name: <span style="color: #FFCC33">&quot;Italy&quot;</span><span style="color: #AA0000; background-color: #FFAAAA">}</span>),
(zidane)<span style="color: #555555">-</span>[:OF_NATIONAL_TEAM<span style="color: #AA0000; background-color: #FFAAAA">{</span>debut: <span style="color: #FFCC33">&quot;19940817&quot;</span><span style="color: #AA0000; background-color: #FFAAAA">}</span>]<span style="color: #555555">-&gt;</span>(france),
(zidane)<span style="color: #555555">-</span>[:PLAYED_FOR_CLUB]<span style="color: #555555">-&gt;</span>(cannes),
(zidane)<span style="color: #555555">-</span>[:PLAYED_FOR_CLUB]<span style="color: #555555">-&gt;</span>(bordeaux),
(zidane)<span style="color: #555555">-</span>[:PLAYED_FOR_CLUB]<span style="color: #555555">-&gt;</span>(juventus),
(zidane)<span style="color: #555555">-</span>[:PLAYED_FOR_CLUB]<span style="color: #555555">-&gt;</span>(realmadrid),
(cannes)<span style="color: #555555">-</span>[:OF_FA]<span style="color: #555555">-&gt;</span>(france),
(bordeaux)<span style="color: #555555">-</span>[:OF_FA]<span style="color: #555555">-&gt;</span>(france),
(juventus)<span style="color: #555555">-</span>[:OF_FA]<span style="color: #555555">-&gt;</span>(italy),
(realmadrid)<span style="color: #555555">-</span>[:OF_FA]<span style="color: #555555">-&gt;</span>(spain);
</pre></div>

<p>That is pretty straight forward and easy to grok. We define 8 nodes representing Zidane, the 4 clubs he played for and the 3 countries these clubs play in. Then we define the Relationships between them. Cypher uses the -&gt; to represent a relationship between nodes.</p>

<h1 id="querying-the-graph">Querying the graph</h1>

<p>Querying the graph we created for interesting things is where the fun really is.</p>

<ul>
<li>To figure out what clubs Zidane played for, we will write the following Cypher snippet:</li>
</ul>
<div class="highlight" style="background: #f0f3f3"><pre style="line-height: 125%"><span></span><span style="color: #006699; font-weight: bold">MATCH</span> (zidane)<span style="color: #555555">-</span>[:PLAYED_FOR_CLUB]<span style="color: #555555">-&gt;</span>(club)
<span style="color: #006699; font-weight: bold">RETURN</span> club;
</pre></div>

<p>When executed:</p>
<div class="highlight" style="background: #f0f3f3"><pre style="line-height: 125%"><span></span>neo4j-sh <span style="color: #555555">(</span>?<span style="color: #555555">)</span>$ MATCH <span style="color: #555555">(</span>zidane<span style="color: #555555">)</span>-<span style="color: #555555">[</span>:PLAYED_FOR_CLUB<span style="color: #555555">]</span>-&gt;<span style="color: #555555">(</span>club<span style="color: #555555">)</span>
&gt;             RETURN club;
+--------------------------------------------------+
| club                                             |
+--------------------------------------------------+
| Node<span style="color: #555555">[</span>53<span style="color: #555555">]{</span>founded:1902,name:<span style="color: #CC3300">&quot;A.S. Cannes&quot;</span><span style="color: #555555">}</span>        |
| Node<span style="color: #555555">[</span>54<span style="color: #555555">]{</span>founded:1881,name:<span style="color: #CC3300">&quot;F.C.G. de Bordeaux&quot;</span><span style="color: #555555">}</span> |
| Node<span style="color: #555555">[</span>55<span style="color: #555555">]{</span>founded:1897,name:<span style="color: #CC3300">&quot;Juventus F.C.&quot;</span><span style="color: #555555">}</span>      |
| Node<span style="color: #555555">[</span>56<span style="color: #555555">]{</span>founded:1902,name:<span style="color: #CC3300">&quot;Real Madrid C.F.&quot;</span><span style="color: #555555">}</span>   |
+--------------------------------------------------+
</pre></div>

<p>What if the question is <em>When were all the clubs Zidane played for founded?</em> We will answer it with the following query:</p>
<div class="highlight" style="background: #f0f3f3"><pre style="line-height: 125%"><span></span><span style="color: #006699; font-weight: bold">MATCH</span> (zidane)<span style="color: #555555">-</span>[:PLAYED_FOR_CLUB]<span style="color: #555555">-&gt;</span>(club)
<span style="color: #006699; font-weight: bold">RETURN</span> club.founded;
</pre></div>

<ul>
<li>Let&rsquo;s try to answer <em>When did Zidane make his international debut?</em>. Let&rsquo;s try the following query:</li>
</ul>
<div class="highlight" style="background: #f0f3f3"><pre style="line-height: 125%"><span></span><span style="color: #006699; font-weight: bold">MATCH</span> (zidane)<span style="color: #555555">-</span>[player:OF_NATIONAL_TEAM]<span style="color: #555555">-&gt;</span>(team)
<span style="color: #006699; font-weight: bold">RETURN</span> player.debut;
</pre></div>

<p>This when executed will result in:</p>
<div class="highlight" style="background: #f0f3f3"><pre style="line-height: 125%"><span></span><span style="color: #AAAAAA">+--------------+</span>
<span style="color: #AAAAAA">| player.debut |</span>
<span style="color: #AAAAAA">+--------------+</span>
<span style="color: #AAAAAA">| &quot;19940817&quot;   |</span>
<span style="color: #AAAAAA">+--------------+</span>
</pre></div>

<p>Here, _[player:OF_NATIONAL<em>TEAM]</em> specifies a relationship of type _OF_NATIONAL<em>TEAM</em> and labels it as <em>player</em> so that we can later extract out the <em>debut</em> property from <em>player</em>.</p>

<p>It can be seen from this example that, sometimes we are not really interested in extracting out certain information, although we want that information to be part of the query. Here, we don&rsquo;t really care what national team Zidane played for, we are just intested in an attribute of the relationship. Cypher allows you to represent this intend to ignore.</p>
<div class="highlight" style="background: #f0f3f3"><pre style="line-height: 125%"><span></span><span style="color: #006699; font-weight: bold">MATCH</span> (zidane)<span style="color: #555555">-</span>[player:OF_NATIONAL_TEAM]<span style="color: #555555">-&gt;</span>()
<span style="color: #006699; font-weight: bold">RETURN</span> player.debut;
</pre></div>

<p>The above query will produce the same result as the previous query. The <em>()</em> specifies that there is some node there, but we are not interested in what it represents.</p>

<ul>
<li>The ability to ignore can be leveraged to answer our next question. <em>What all countries have Zidane played league football in?</em></li>
</ul>
<div class="highlight" style="background: #f0f3f3"><pre style="line-height: 125%"><span></span><span style="color: #006699; font-weight: bold">MATCH</span> (zidane)<span style="color: #555555">-</span>[:PLAYED_FOR_CLUB]<span style="color: #555555">-&gt;</span>()<span style="color: #555555">-</span>[:OF_FA]<span style="color: #555555">-&gt;</span>(fa)
<span style="color: #006699; font-weight: bold">RETURN</span> <span style="color: #006699; font-weight: bold">DISTINCT</span> fa.name;
</pre></div>

<p>The result:</p>
<div class="highlight" style="background: #f0f3f3"><pre style="line-height: 125%"><span></span>+----------+
| fa.name  |
+----------+
| <span style="color: #CC3300">&quot;France&quot;</span> |
| <span style="color: #CC3300">&quot;Italy&quot;</span>  |
| <span style="color: #CC3300">&quot;Spain&quot;</span>  |
+----------+
</pre></div>

<p>We use <em>DISTINCT</em> to get uniques because Zidane played for Cannes and Bordeaux, both of the French Ligue 1.</p>

<h1 id="summary">Summary</h1>

<p>I am still making my way through the book. So far it has looked promising and I have been able to grasp things. I am looking forward to learning more complex querying and will write about it in the subsequent blog posts.</p>
<div class="footnotes">

<hr />

<ol>
<li id="fn:1"><a href="http://graphdatabases.com/">Graph Databases by Ian Robinson, Jim Webber, and Emil Eifrem (O’Reilly). Copyright 2013 Neo Technology, Inc., 978-1-449-35626-2.</a>
 <a class="footnote-return" href="#fnref:1"><sup>[return]</sup></a></li>
<li id="fn:2"><a href="http://www.neotechnology.com/">Neo Technology</a>
 <a class="footnote-return" href="#fnref:2"><sup>[return]</sup></a></li>
<li id="fn:3"><a href="http://www.neo4j.org/">Neo4j</a>
 <a class="footnote-return" href="#fnref:3"><sup>[return]</sup></a></li>
<li id="fn:4"><a href="http://blog.sdqali.in/blog/2012/05/30/the-spiral-of-learning/">The Spiral of Learning</a>
 <a class="footnote-return" href="#fnref:4"><sup>[return]</sup></a></li>
<li id="fn:5"><a href="http://docs.neo4j.org/chunked/stable/cypher-introduction.html">What is Cypher?</a>
 <a class="footnote-return" href="#fnref:5"><sup>[return]</sup></a></li>
</ol>
</div>
            <p class="comments">
  If you have questions or comments about this blog post, you can get in touch with me on Twitter <a href="https://twitter.com/sdqali">@sdqali</a>.
</p>

          </div>
        </div>
      </div>
    </article>

    <hr>

    
<footer>
  <div class="container">
    <div class="row">
      <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
        <ul class="list-inline text-center">
          <li>
            <a href="https://twitter.com/sdqali">
              <span class="fa-stack fa-lg">
                <i class="fa fa-circle fa-stack-2x"></i>
                <i class="fa fa-twitter fa-stack-1x fa-inverse"></i>
              </span>
            </a>
          </li>
          <li>
            <a href="https://linkedin.com/in/sdqali">
              <span class="fa-stack fa-lg">
                <i class="fa fa-circle fa-stack-2x"></i>
                <i class="fa fa-linkedin fa-stack-1x fa-inverse"></i>
              </span>
            </a>
          </li>
          <li>
            <a href="https://github.com/sdqali">
              <span class="fa-stack fa-lg">
                <i class="fa fa-circle fa-stack-2x"></i>
                <i class="fa fa-github fa-stack-1x fa-inverse"></i>
              </span>
            </a>
          </li>
          <li>
            <a href="/index.xml">
              <span class="fa-stack fa-lg">
                <i class="fa fa-circle fa-stack-2x"></i>
                <i class="fa fa-rss fa-stack-1x fa-inverse"></i>
              </span>
            </a>
          </li>
        </ul>
        <p class="copyright text-muted">&copy; All rights reserved.</p>
      </div>
    </div>
  </div>
</footer>


<script src="/js/jquery.js"></script>


<script src="/js/bootstrap.min.js"></script>


<script src="/js/clean-blog.min.js"></script>

<script src="/js/keen.min.3.3.0.js" type="text/javascript"></script>
<script src="/js/parseuri.js" type="text/javascript"></script>
<script src="/js/ua-parser.min.js" type="text/javascript
"></script>
 <script src="/js/Math.uuid.js" type="text/javascript"></script>
<script src="/js/analytics.js" type="text/javascript"></script>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

  ga('create', '', 'auto');
  ga('send', 'pageview');

</script>


  </body>
</html>
